2025-11-19 23:11:05,504 - __main__ - INFO - üìä –ó–∞–≥—Ä—É–∑–∫–∞ –±–µ–Ω—á–º–∞—Ä–∫–∞: /home/dark/Documents/GitHub/SQL_Agent_proj/tests/benchmark_3000.json
2025-11-19 23:11:05,517 - __main__ - INFO - ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 3000 –ø—Ä–∏–º–µ—Ä–æ–≤
2025-11-19 23:11:05,517 - __main__ - INFO - üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤—ã—Ö 20 –ø—Ä–∏–º–µ—Ä–æ–≤
2025-11-19 23:11:05,517 - __main__ - INFO - üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...
2025-11-19 23:11:06,591 - core.database_adapter - INFO - Cached schema for 9 tables
2025-11-19 23:11:07,729 - core.llm_manager - INFO - Initialized LLM Manager with gemini provider, model: models/gemini-2.5-flash-lite
2025-11-19 23:11:07,729 - agents.orchestrator - INFO - [ORCHESTRATOR] Creating dynamic semantic layer...
2025-11-19 23:11:07,729 - core.dynamic_semantic_layer - INFO - Auto-discovering database schema...
2025-11-19 23:11:07,736 - core.dynamic_semantic_layer - INFO - Discovered 9 tables with 344 semantic mappings
2025-11-19 23:11:07,736 - agents.orchestrator - INFO - [ORCHESTRATOR] Creating enhanced RAG system...
2025-11-19 23:11:07,736 - core.enhanced_rag_system - INFO - Loading embedding model: all-MiniLM-L6-v2
2025-11-19 23:11:07,860 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda:0
2025-11-19 23:11:07,860 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-19 23:11:19,870 - chromadb.telemetry.product.posthog - ERROR - Failed to send telemetry event ClientStartEvent: capture() takes 1 positional argument but 3 were given
2025-11-19 23:11:19,873 - chromadb.telemetry.product.posthog - ERROR - Failed to send telemetry event ClientCreateCollectionEvent: capture() takes 1 positional argument but 3 were given
2025-11-19 23:11:19,873 - core.enhanced_rag_system - INFO - Initialized Enhanced RAG system for postgresql
2025-11-19 23:11:19,877 - core.enhanced_rag_system - INFO - Loading column descriptions from data/HomeCredit_columns_description.csv (encoding: latin-1)
2025-11-19 23:11:19,891 - core.enhanced_rag_system - INFO - Loaded 219 column descriptions
2025-11-19 23:11:19,907 - core.sql_generator - INFO - Initialized SQL Generator for postgresql
2025-11-19 23:11:19,907 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Initialized for postgresql
2025-11-19 23:11:19,907 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∞–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞
2025-11-19 23:11:19,908 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∞–≥–µ–Ω—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
2025-11-19 23:11:19,908 - agents.orchestrator - INFO - [ORCHESTRATOR] Initialized with strict pipeline: Analysis ‚Üí SQL+RAG ‚Üí Visualization
2025-11-19 23:11:19,908 - __main__ - INFO - üöÄ –ù–∞—á–∞–ª–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏...
2025-11-19 23:11:19,908 - __main__ - INFO - 
[1/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞ –ø–æ —Å–µ–º–µ–π–Ω—ã–º —Å—Ç–∞—Ç—É—Å–∞–º –¥–ª—è —Å–µ–≥–º...
2025-11-19 23:11:19,908 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞ –ø–æ —Å–µ–º–µ–π–Ω—ã–º —Å—Ç–∞—Ç—É—Å–∞–º –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –≤—ã—Å—à...'
2025-11-19 23:11:19,908 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:11:21,132 - core.llm_manager - INFO - Generated response in 1.22s, tokens: 104
2025-11-19 23:11:21,133 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Analyze the average approved loan size by marital status for the segment of clients with higher educ...'
2025-11-19 23:11:21,136 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:11:21,136 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:11:21,889 - core.llm_manager - INFO - Generated response in 0.75s, tokens: 226
2025-11-19 23:11:21,889 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:11:21,889 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the average approved loan size, grouped by marital status, for clients who have higher edu...
2025-11-19 23:11:21,889 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the average approved loan size, grouped by marital status, for clients who have higher edu...'
2025-11-19 23:11:21,889 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:11:21,890 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the average approved loan size, grouped by marital status, for clients who have higher edu...'
2025-11-19 23:11:21,890 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  2.70it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  2.69it/s]
2025-11-19 23:11:22,374 - chromadb.telemetry.product.posthog - ERROR - Failed to send telemetry event CollectionQueryEvent: capture() takes 1 positional argument but 3 were given
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 175.57it/s]
2025-11-19 23:11:22,395 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:11:22,395 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the average approved loan size, grouped by marital status, for clients who have higher edu...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 193.19it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 183.75it/s]
2025-11-19 23:11:22,442 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:11:28,426 - core.llm_manager - INFO - Generated response in 5.98s, tokens: 15667
2025-11-19 23:11:28,444 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 6.05s after 0 retries
2025-11-19 23:11:28,446 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:11:28,446 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:11:31,956 - core.database_adapter - INFO - Query executed in 3.50s, returned 6 rows
2025-11-19 23:11:31,957 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 6 rows in 3.50s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 83.99it/s]
2025-11-19 23:11:32,011 - chromadb.telemetry.product.posthog - ERROR - Failed to send telemetry event CollectionAddEvent: capture() takes 1 positional argument but 3 were given
2025-11-19 23:11:32,011 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:11:32,012 - core.dynamic_semantic_layer - INFO - Learned from query: 2 tables, feedback: None
2025-11-19 23:11:32,012 - core.enhanced_rag_system - INFO - Learned from query execution: 6 rows in 3.50s
2025-11-19 23:11:32,012 - core.dynamic_semantic_layer - INFO - Learned from query: 2 tables, feedback: successful
2025-11-19 23:11:32,012 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 10.12s
2025-11-19 23:11:32,013 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=6, time=3.50s
2025-11-19 23:11:32,013 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:11:32,013 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=6, cols=2, question='Calculate the average approved loan size, grouped by marital...'
2025-11-19 23:11:32,013 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:11:32,273 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:11:32,275 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:11:32,275 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpba3p6abo.
2025-11-19 23:11:32,275 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:11:32,276 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmp_7j5gs5k.
2025-11-19 23:11:32,298 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:11:32,298 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmp_7j5gs5k
2025-11-19 23:11:33,146 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpba3p6abo/index.html
2025-11-19 23:11:33,146 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:11:35,244 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:11:35,246 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:11:35,246 - kaleido.kaleido - INFO - Got F748
2025-11-19 23:11:35,246 - kaleido._kaleido_tab - INFO - Processing avg_approved_loan_size_by_name_family_status.png
2025-11-19 23:11:35,246 - kaleido._kaleido_tab - INFO - Sending big command for avg_approved_loan_size_by_name_family_status.png.
2025-11-19 23:11:35,420 - kaleido._kaleido_tab - INFO - Sent big command for avg_approved_loan_size_by_name_family_status.png.
2025-11-19 23:11:35,421 - kaleido.kaleido - INFO - Reloading tab F748 before return.
2025-11-19 23:11:35,626 - kaleido.kaleido - INFO - Putting tab F748 back (queue size: 0).
2025-11-19 23:11:35,626 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:11:35,626 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:11:35,626 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:11:35,639 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:11:35,640 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:11:35,640 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:11:35,640 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:11:35,640 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:11:36,013 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:11:36,015 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:11:36,015 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:11:36,015 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:11:36,015 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:11:36,015 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:11:36,019 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=43993 bytes
2025-11-19 23:11:36,020 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:11:36,020 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:11:36,020 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate the average approved loan size, grouped by marital...', rows=6, cols=2
2025-11-19 23:11:36,028 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:11:37,522 - core.llm_manager - INFO - Generated response in 1.49s, tokens: 600
2025-11-19 23:11:37,523 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 924 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:11:37,523 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=0, recommendations=2, confidence=0.85
2025-11-19 23:11:37,523 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=0
2025-11-19 23:11:37,524 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:11:38,628 - core.llm_manager - INFO - Generated response in 1.10s, tokens: 386
2025-11-19 23:11:40,968 - core.llm_manager - INFO - Generated response in 2.34s, tokens: 524
2025-11-19 23:11:42,173 - core.llm_manager - INFO - Generated response in 1.20s, tokens: 62
2025-11-19 23:11:42,610 - core.llm_manager - INFO - Generated response in 0.44s, tokens: 58
2025-11-19 23:11:43,157 - core.llm_manager - INFO - Generated response in 0.55s, tokens: 106
2025-11-19 23:11:43,157 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:11:43,160 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...ME_FAMILY_STATUS ORDER BY AVG(pa.AMT_CREDIT) DESC; LIMIT 100
                                                              ^

[SQL: SELECT at.NAME_FAMILY_STATUS, AVG(pa.AMT_CREDIT) FROM application_train at JOIN previous_application pa ON at.SK_ID_CURR = pa.SK_ID_CURR WHERE at.NAME_EDUCATION_TYPE = 'Higher education' AND pa.NAME_CONTRACT_STATUS = 'Approved' GROUP BY at.NAME_FAMILY_STATUS ORDER BY AVG(pa.AMT_CREDIT) DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:11:43,161 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...ME_FAMILY_STATUS ORDER BY AVG(pa.AMT_CREDIT) DESC; LIMIT 100
                                                              ^

[SQL: SELECT at.NAME_FAMILY_STATUS, AVG(pa.AMT_CREDIT) FROM application_train at JOIN previous_application pa ON at.SK_ID_CURR = pa.SK_ID_CURR WHERE at.NAME_EDUCATION_TYPE = 'Higher education' AND pa.NAME_CONTRACT_STATUS = 'Approved' GROUP BY at.NAME_FAMILY_STATUS ORDER BY AVG(pa.AMT_CREDIT) DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:11:43,161 - __main__ - INFO - 
[2/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å—Ä–µ–¥–Ω–µ–≥–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –¥–ª—è –≥—Ä—É–ø–ø –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ–±–ª–∞–¥–∞—é—â–∏—Ö ...
2025-11-19 23:11:43,161 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å—Ä–µ–¥–Ω–µ–≥–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –¥–ª—è –≥—Ä—É–ø–ø –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ–±–ª–∞–¥–∞—é—â–∏—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º –∏ –Ω–µ –∏–º–µ...'
2025-11-19 23:11:43,161 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:11:43,538 - core.llm_manager - INFO - Generated response in 0.38s, tokens: 83
2025-11-19 23:11:43,539 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Comparative analysis of average aggregate income for customer groups with and without a car....'
2025-11-19 23:11:43,539 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:11:43,539 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:11:45,936 - core.llm_manager - INFO - Generated response in 2.40s, tokens: 222
2025-11-19 23:11:45,936 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:11:45,937 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the average aggregate income for customer groups, segmented by whether they own a car or n...
2025-11-19 23:11:45,937 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the average aggregate income for customer groups, segmented by whether they own a car or n...'
2025-11-19 23:11:45,937 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:11:45,937 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the average aggregate income for customer groups, segmented by whether they own a car or n...'
2025-11-19 23:11:45,937 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 102.65it/s]
2025-11-19 23:11:45,962 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:11:45,963 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 166.97it/s]
2025-11-19 23:11:45,989 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:11:45,990 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the average aggregate income for customer groups, segmented by whether they own a car or n...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 157.78it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 190.23it/s]
2025-11-19 23:11:46,030 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:11:47,525 - core.llm_manager - INFO - Generated response in 1.49s, tokens: 15456
2025-11-19 23:11:47,528 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 1.54s after 0 retries
2025-11-19 23:11:47,528 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:11:47,529 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:11:48,019 - core.database_adapter - INFO - Query executed in 0.49s, returned 2 rows
2025-11-19 23:11:48,020 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 2 rows in 0.49s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 136.36it/s]
2025-11-19 23:11:48,048 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:11:48,048 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:11:48,049 - core.enhanced_rag_system - INFO - Learned from query execution: 2 rows in 0.49s
2025-11-19 23:11:48,049 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:11:48,049 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 2.11s
2025-11-19 23:11:48,049 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=2, time=0.49s
2025-11-19 23:11:48,049 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:11:48,050 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=2, cols=2, question='Calculate the average aggregate income for customer groups, ...'
2025-11-19 23:11:48,050 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:11:48,095 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:11:48,096 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:11:48,096 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpvwrbj_yq.
2025-11-19 23:11:48,096 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:11:48,097 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpidpfzx8l.
2025-11-19 23:11:48,107 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:11:48,110 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpidpfzx8l
2025-11-19 23:11:48,906 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpvwrbj_yq/index.html
2025-11-19 23:11:48,906 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:11:52,524 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:11:52,526 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:11:52,526 - kaleido.kaleido - INFO - Got 7EC6
2025-11-19 23:11:52,526 - kaleido._kaleido_tab - INFO - Processing average_income_by_flag_own_car.png
2025-11-19 23:11:52,526 - kaleido._kaleido_tab - INFO - Sending big command for average_income_by_flag_own_car.png.
2025-11-19 23:11:52,671 - kaleido._kaleido_tab - INFO - Sent big command for average_income_by_flag_own_car.png.
2025-11-19 23:11:52,672 - kaleido.kaleido - INFO - Reloading tab 7EC6 before return.
2025-11-19 23:11:52,887 - kaleido.kaleido - INFO - Putting tab 7EC6 back (queue size: 0).
2025-11-19 23:11:52,888 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:11:52,888 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:11:52,888 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:11:52,890 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:11:52,892 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:11:52,892 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:11:52,892 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:11:52,893 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:11:53,115 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:11:53,115 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:11:53,115 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:11:53,118 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:11:53,118 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:11:53,118 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:11:53,122 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=25476 bytes
2025-11-19 23:11:53,123 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:11:53,124 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:11:53,124 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate the average aggregate income for customer groups, ...', rows=2, cols=2
2025-11-19 23:11:53,128 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:11:54,540 - core.llm_manager - INFO - Generated response in 1.41s, tokens: 572
2025-11-19 23:11:54,540 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 1140 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:11:54,540 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=0, recommendations=2, confidence=0.70
2025-11-19 23:11:54,540 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=0
2025-11-19 23:11:54,541 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:11:55,345 - core.llm_manager - INFO - Generated response in 0.80s, tokens: 383
2025-11-19 23:11:56,513 - core.llm_manager - INFO - Generated response in 1.17s, tokens: 632
2025-11-19 23:11:57,133 - core.llm_manager - INFO - Generated response in 0.62s, tokens: 62
2025-11-19 23:11:57,484 - core.llm_manager - INFO - Generated response in 0.35s, tokens: 58
2025-11-19 23:11:58,383 - core.llm_manager - INFO - Generated response in 0.90s, tokens: 122
2025-11-19 23:11:58,383 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:11:58,386 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...TAL) FROM application_train GROUP BY FLAG_OWN_CAR; LIMIT 100
                                                              ^

[SQL: SELECT FLAG_OWN_CAR, AVG(AMT_INCOME_TOTAL) FROM application_train GROUP BY FLAG_OWN_CAR; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:11:58,386 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...TAL) FROM application_train GROUP BY FLAG_OWN_CAR; LIMIT 100
                                                              ^

[SQL: SELECT FLAG_OWN_CAR, AVG(AMT_INCOME_TOTAL) FROM application_train GROUP BY FLAG_OWN_CAR; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:11:58,386 - __main__ - INFO - 
[3/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ü–æ —Ç–∞–±–ª–∏—Ü–µ POS_CASH_balance —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è DPD_DEF –ø–æ P...
2025-11-19 23:11:58,386 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ü–æ —Ç–∞–±–ª–∏—Ü–µ POS_CASH_balance —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è DPD_DEF –ø–æ POS-–∫—Ä–µ–¥–∏—Ç–∞–º (SK_DPD_...'
2025-11-19 23:11:58,386 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:11:58,953 - core.llm_manager - INFO - Generated response in 0.57s, tokens: 127
2025-11-19 23:11:58,955 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Using the POS_CASH_balance table, calculate the average DPD_DEF value (SK_DPD_DEF) for POS loans (SK...'
2025-11-19 23:11:58,955 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:11:58,955 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:11:59,675 - core.llm_manager - INFO - Generated response in 0.72s, tokens: 235
2025-11-19 23:11:59,676 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:11:59,676 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: SELECT SK_ID_CURR, AVG(SK_DPD_DEF) FROM POS_CASH_balance WHERE DPD > 0 GROUP BY SK_ID_CURR...
2025-11-19 23:11:59,679 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'SELECT SK_ID_CURR, AVG(SK_DPD_DEF) FROM POS_CASH_balance WHERE DPD > 0 GROUP BY SK_ID_CURR...'
2025-11-19 23:11:59,679 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:11:59,679 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'SELECT SK_ID_CURR, AVG(SK_DPD_DEF) FROM POS_CASH_balance WHERE DPD > 0 GROUP BY SK_ID_CURR...'
2025-11-19 23:11:59,679 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 168.87it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 194.12it/s]
2025-11-19 23:11:59,723 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:11:59,724 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'SELECT SK_ID_CURR, AVG(SK_DPD_DEF) FROM POS_CASH_balance WHERE DPD > 0 GROUP BY SK_ID_CURR...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 198.79it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 198.92it/s]
2025-11-19 23:11:59,762 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:12:00,341 - core.llm_manager - INFO - Generated response in 0.58s, tokens: 15930
2025-11-19 23:12:00,428 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.70s after 0 retries
2025-11-19 23:12:00,429 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:12:00,429 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:12:29,132 - core.database_adapter - INFO - Query executed in 28.69s, returned 100 rows
2025-11-19 23:12:29,135 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 100 rows in 28.69s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 44.76it/s]
2025-11-19 23:12:29,250 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:12:29,250 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:12:29,250 - core.enhanced_rag_system - INFO - Learned from query execution: 100 rows in 28.69s
2025-11-19 23:12:29,250 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:12:29,250 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 29.57s
2025-11-19 23:12:29,250 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=100, time=28.69s
2025-11-19 23:12:29,250 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:12:29,251 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=100, cols=2, question='SELECT SK_ID_CURR, AVG(SK_DPD_DEF) FROM POS_CASH_balance WHE...'
2025-11-19 23:12:29,251 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:12:29,286 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:12:29,286 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:12:29,299 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:12:29,300 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:12:29,300 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmporcokg95.
2025-11-19 23:12:29,301 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:12:29,301 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpu2vdvhg1.
2025-11-19 23:12:29,316 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:12:29,316 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpu2vdvhg1
2025-11-19 23:12:30,081 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmporcokg95/index.html
2025-11-19 23:12:30,082 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:12:32,143 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:12:32,145 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:12:32,145 - kaleido.kaleido - INFO - Got 19D2
2025-11-19 23:12:32,145 - kaleido._kaleido_tab - INFO - Processing avg_sk_dpd_def_by_sk_id_curr.png
2025-11-19 23:12:32,145 - kaleido._kaleido_tab - INFO - Sending big command for avg_sk_dpd_def_by_sk_id_curr.png.
2025-11-19 23:12:32,370 - kaleido._kaleido_tab - INFO - Sent big command for avg_sk_dpd_def_by_sk_id_curr.png.
2025-11-19 23:12:32,371 - kaleido.kaleido - INFO - Reloading tab 19D2 before return.
2025-11-19 23:12:32,564 - kaleido.kaleido - INFO - Putting tab 19D2 back (queue size: 0).
2025-11-19 23:12:32,564 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:12:32,564 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:12:32,564 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:12:32,565 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:12:32,566 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:12:32,566 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:12:32,566 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:12:32,567 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:12:32,787 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:12:32,792 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:12:32,792 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:12:32,792 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:12:32,792 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:12:32,793 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:12:32,796 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=27243 bytes
2025-11-19 23:12:32,797 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:12:32,797 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:12:32,797 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='SELECT SK_ID_CURR, AVG(SK_DPD_DEF) FROM POS_CASH_balance WHE...', rows=100, cols=2
2025-11-19 23:12:32,807 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:12:34,936 - core.llm_manager - INFO - Generated response in 2.13s, tokens: 778
2025-11-19 23:12:34,936 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 1870 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:12:34,936 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=4, recommendations=2, confidence=1.00
2025-11-19 23:12:34,937 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=4
2025-11-19 23:12:34,938 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:12:36,376 - core.llm_manager - INFO - Generated response in 1.44s, tokens: 392
2025-11-19 23:12:37,792 - core.llm_manager - INFO - Generated response in 1.41s, tokens: 843
2025-11-19 23:12:38,547 - core.llm_manager - INFO - Generated response in 0.75s, tokens: 60
2025-11-19 23:12:38,992 - core.llm_manager - INFO - Generated response in 0.44s, tokens: 56
2025-11-19 23:12:39,416 - core.llm_manager - INFO - Generated response in 0.42s, tokens: 59
2025-11-19 23:12:41,466 - core.llm_manager - INFO - Generated response in 2.05s, tokens: 58
2025-11-19 23:12:42,010 - core.llm_manager - INFO - Generated response in 0.54s, tokens: 68
2025-11-19 23:12:42,563 - core.llm_manager - INFO - Generated response in 0.55s, tokens: 67
2025-11-19 23:12:43,138 - core.llm_manager - INFO - Generated response in 0.57s, tokens: 93
2025-11-19 23:12:43,139 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:12:43,140 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ... GROUP BY SK_ID_CURR ORDER BY avg_sk_dpd_def DESC; LIMIT 100
                                                              ^

[SQL: SELECT SK_ID_CURR AS group_key, AVG(SK_DPD_DEF) AS avg_sk_dpd_def FROM POS_CASH_balance WHERE SK_DPD > 0 GROUP BY SK_ID_CURR ORDER BY avg_sk_dpd_def DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:12:43,140 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ... GROUP BY SK_ID_CURR ORDER BY avg_sk_dpd_def DESC; LIMIT 100
                                                              ^

[SQL: SELECT SK_ID_CURR AS group_key, AVG(SK_DPD_DEF) AS avg_sk_dpd_def FROM POS_CASH_balance WHERE SK_DPD > 0 GROUP BY SK_ID_CURR ORDER BY avg_sk_dpd_def DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:12:43,140 - __main__ - INFO - 
[4/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å (WITH + JOIN) –ø–æ previous_application –∏ installment...
2025-11-19 23:12:43,140 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å (WITH + JOIN) –ø–æ previous_application –∏ installments_payments, –∫–æ—Ç–æ—Ä—ã–π ...'
2025-11-19 23:12:43,141 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:12:45,593 - core.llm_manager - INFO - Generated response in 2.45s, tokens: 196
2025-11-19 23:12:45,593 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Construct a complex SQL query (WITH + JOIN) on previous_application and installments_payments, which...'
2025-11-19 23:12:45,593 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:12:45,593 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:12:47,528 - core.llm_manager - INFO - Generated response in 1.93s, tokens: 361
2025-11-19 23:12:47,529 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:12:47,529 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Construct a complex SQL query (WITH + JOIN) on previous_application and installments_payments, which...'
2025-11-19 23:12:47,529 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:12:47,530 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Construct a complex SQL query (WITH + JOIN) on previous_application and installments_payments, which...'
2025-11-19 23:12:47,530 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 49.86it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.13it/s]
2025-11-19 23:12:47,587 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:12:47,587 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Construct a complex SQL query (WITH + JOIN) on previous_application and installments_payments, which...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.98it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.72it/s]
2025-11-19 23:12:47,628 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:12:48,694 - core.llm_manager - INFO - Generated response in 1.07s, tokens: 1927
2025-11-19 23:12:48,714 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 1.13s after 0 retries
2025-11-19 23:12:48,714 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:12:48,715 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:13:31,934 - core.database_adapter - INFO - Query executed in 43.21s, returned 100 rows
2025-11-19 23:13:31,934 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 100 rows in 43.21s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 26.30it/s]
2025-11-19 23:13:32,044 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:13:32,045 - core.dynamic_semantic_layer - INFO - Learned from query: 2 tables, feedback: None
2025-11-19 23:13:32,045 - core.enhanced_rag_system - INFO - Learned from query execution: 100 rows in 43.21s
2025-11-19 23:13:32,047 - core.dynamic_semantic_layer - INFO - Learned from query: 2 tables, feedback: successful
2025-11-19 23:13:32,047 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 44.52s
2025-11-19 23:13:32,047 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=100, time=43.21s
2025-11-19 23:13:32,047 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:13:32,048 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=100, cols=1, question='Construct a complex SQL query (WITH + JOIN) on previous_appl...'
2025-11-19 23:13:32,048 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:13:32,139 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:13:32,139 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:13:32,139 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpok_zs8wv.
2025-11-19 23:13:32,140 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:13:32,140 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpxoyyba4x.
2025-11-19 23:13:32,155 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:13:32,155 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpxoyyba4x
2025-11-19 23:13:32,702 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpok_zs8wv/index.html
2025-11-19 23:13:32,703 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:13:34,822 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:13:34,822 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:13:34,823 - kaleido.kaleido - INFO - Got 2FDB
2025-11-19 23:13:34,823 - kaleido._kaleido_tab - INFO - Processing avg_delay_per_client_by_index.png
2025-11-19 23:13:34,823 - kaleido._kaleido_tab - INFO - Sending big command for avg_delay_per_client_by_index.png.
2025-11-19 23:13:34,984 - kaleido._kaleido_tab - INFO - Sent big command for avg_delay_per_client_by_index.png.
2025-11-19 23:13:34,985 - kaleido.kaleido - INFO - Reloading tab 2FDB before return.
2025-11-19 23:13:35,169 - kaleido.kaleido - INFO - Putting tab 2FDB back (queue size: 0).
2025-11-19 23:13:35,169 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:13:35,169 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:13:35,169 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:13:35,172 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:13:35,174 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:13:35,175 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:13:35,175 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:13:35,175 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:13:35,497 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:13:35,497 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:13:35,498 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:13:35,498 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:13:35,498 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:13:35,498 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:13:35,501 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=29130 bytes
2025-11-19 23:13:35,501 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:13:35,501 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:13:35,501 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Construct a complex SQL query (WITH + JOIN) on previous_appl...', rows=100, cols=1
2025-11-19 23:13:35,513 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:13:37,521 - core.llm_manager - INFO - Generated response in 2.01s, tokens: 1018
2025-11-19 23:13:37,521 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 2009 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:13:37,521 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=4, recommendations=2, confidence=1.00
2025-11-19 23:13:37,521 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=4
2025-11-19 23:13:37,522 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:13:38,832 - core.llm_manager - INFO - Generated response in 1.31s, tokens: 373
2025-11-19 23:13:40,248 - core.llm_manager - INFO - Generated response in 1.42s, tokens: 897
2025-11-19 23:13:41,253 - core.llm_manager - INFO - Generated response in 1.00s, tokens: 60
2025-11-19 23:13:41,910 - core.llm_manager - INFO - Generated response in 0.66s, tokens: 60
2025-11-19 23:13:42,544 - core.llm_manager - INFO - Generated response in 0.63s, tokens: 62
2025-11-19 23:13:43,240 - core.llm_manager - INFO - Generated response in 0.70s, tokens: 61
2025-11-19 23:13:44,085 - core.llm_manager - INFO - Generated response in 0.84s, tokens: 68
2025-11-19 23:13:44,721 - core.llm_manager - INFO - Generated response in 0.63s, tokens: 67
2025-11-19 23:13:45,979 - core.llm_manager - INFO - Generated response in 1.26s, tokens: 230
2025-11-19 23:13:45,979 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:13:45,981 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...te' ELSE 'on_time' END ORDER BY metric_value DESC; LIMIT 100
                                                              ^

[SQL: WITH inst AS ( SELECT pa.SK_ID_CURR, pa.NAME_CONTRACT_TYPE, pa.NAME_CLIENT_TYPE, pa.CHANNEL_TYPE, pa.NAME_YIELD_GROUP, ip.NUM_INSTALMENT_NUMBER, ip.DAYS_INSTALMENT, ip.DAYS_ENTRY_PAYMENT, ip.AMT_INSTALMENT, ip.AMT_PAYMENT, (ip.DAYS_ENTRY_PAYMENT - ip.DAYS_INSTALMENT) AS delay_days, (ip.AMT_PAYMENT - ip.AMT_INSTALMENT) AS payment_diff, AVG(ip.DAYS_ENTRY_PAYMENT - ip.DAYS_INSTALMENT) OVER (PARTITION BY pa.SK_ID_CURR) AS avg_delay_per_client FROM previous_application pa JOIN installments_payments ip ON pa.SK_ID_PREV = ip.SK_ID_PREV WHERE pa.NAME_CLIENT_TYPE = 'Repeater' ) SELECT CASE WHEN delay_days > 0 THEN 'late' ELSE 'on_time' END AS group_key, AVG(avg_delay_per_client) AS metric_value FROM inst GROUP BY CASE WHEN delay_days > 0 THEN 'late' ELSE 'on_time' END ORDER BY metric_value DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:13:45,982 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...te' ELSE 'on_time' END ORDER BY metric_value DESC; LIMIT 100
                                                              ^

[SQL: WITH inst AS ( SELECT pa.SK_ID_CURR, pa.NAME_CONTRACT_TYPE, pa.NAME_CLIENT_TYPE, pa.CHANNEL_TYPE, pa.NAME_YIELD_GROUP, ip.NUM_INSTALMENT_NUMBER, ip.DAYS_INSTALMENT, ip.DAYS_ENTRY_PAYMENT, ip.AMT_INSTALMENT, ip.AMT_PAYMENT, (ip.DAYS_ENTRY_PAYMENT - ip.DAYS_INSTALMENT) AS delay_days, (ip.AMT_PAYMENT - ip.AMT_INSTALMENT) AS payment_diff, AVG(ip.DAYS_ENTRY_PAYMENT - ip.DAYS_INSTALMENT) OVER (PARTITION BY pa.SK_ID_CURR) AS avg_delay_per_client FROM previous_application pa JOIN installments_payments ip ON pa.SK_ID_PREV = ip.SK_ID_PREV WHERE pa.NAME_CLIENT_TYPE = 'Repeater' ) SELECT CASE WHEN delay_days > 0 THEN 'late' ELSE 'on_time' END AS group_key, AVG(avg_delay_per_client) AS metric_value FROM inst GROUP BY CASE WHEN delay_days > 0 THEN 'late' ELSE 'on_time' END ORDER BY metric_value DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:13:45,982 - __main__ - INFO - 
[5/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–æ–≥–¥–∞ –∫ –Ω–∞–º —á–∞—â–µ –≤—Å–µ–≥–æ –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∑–∞ –∫—Ä–µ–¥–∏—Ç–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è?...
2025-11-19 23:13:45,982 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–æ–≥–¥–∞ –∫ –Ω–∞–º —á–∞—â–µ –≤—Å–µ–≥–æ –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∑–∞ –∫—Ä–µ–¥–∏—Ç–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è?...'
2025-11-19 23:13:45,982 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:13:46,591 - core.llm_manager - INFO - Generated response in 0.61s, tokens: 62
2025-11-19 23:13:46,591 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'When do people most often apply for loans during the day?...'
2025-11-19 23:13:46,592 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:13:46,592 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:13:47,454 - core.llm_manager - INFO - Generated response in 0.86s, tokens: 185
2025-11-19 23:13:47,455 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:13:47,455 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Count loan applications by hour of the day....
2025-11-19 23:13:47,455 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Count loan applications by hour of the day....'
2025-11-19 23:13:47,455 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:13:47,455 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Count loan applications by hour of the day....'
2025-11-19 23:13:47,455 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  7.96it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00,  7.94it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 146.99it/s]
2025-11-19 23:13:47,643 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:13:47,644 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Count loan applications by hour of the day....' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 177.51it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 190.57it/s]
2025-11-19 23:13:47,690 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:13:48,728 - core.llm_manager - INFO - Generated response in 1.04s, tokens: 15574
2025-11-19 23:13:48,833 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 1.19s after 0 retries
2025-11-19 23:13:48,834 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:13:48,834 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:14:04,003 - core.database_adapter - INFO - Query executed in 15.17s, returned 24 rows
2025-11-19 23:14:04,005 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 24 rows in 15.17s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 64.68it/s]
2025-11-19 23:14:04,039 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:14:04,039 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:14:04,039 - core.enhanced_rag_system - INFO - Learned from query execution: 24 rows in 15.17s
2025-11-19 23:14:04,039 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:14:04,039 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 16.58s
2025-11-19 23:14:04,040 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=24, time=15.17s
2025-11-19 23:14:04,040 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:14:04,040 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=24, cols=2, question='Count loan applications by hour of the day....'
2025-11-19 23:14:04,040 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:14:04,072 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:04,073 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:04,073 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:04,073 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:04,106 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:14:04,106 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:14:04,106 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmp71768w2b.
2025-11-19 23:14:04,107 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:14:04,107 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpx6ko2wzp.
2025-11-19 23:14:04,115 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:14:04,118 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpx6ko2wzp
2025-11-19 23:14:04,681 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmp71768w2b/index.html
2025-11-19 23:14:04,681 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:14:06,882 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:14:06,883 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:14:06,883 - kaleido.kaleido - INFO - Got 4B71
2025-11-19 23:14:06,883 - kaleido._kaleido_tab - INFO - Processing loan_count_by_hour_appr_process_start.png
2025-11-19 23:14:06,883 - kaleido._kaleido_tab - INFO - Sending big command for loan_count_by_hour_appr_process_start.png.
2025-11-19 23:14:07,064 - kaleido._kaleido_tab - INFO - Sent big command for loan_count_by_hour_appr_process_start.png.
2025-11-19 23:14:07,065 - kaleido.kaleido - INFO - Reloading tab 4B71 before return.
2025-11-19 23:14:07,242 - kaleido.kaleido - INFO - Putting tab 4B71 back (queue size: 0).
2025-11-19 23:14:07,242 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:14:07,242 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:14:07,243 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:14:07,245 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:14:07,245 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:07,246 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:07,246 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:14:07,246 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:14:07,422 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:07,422 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:07,423 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:07,423 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:07,423 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:14:07,423 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:14:07,426 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=39207 bytes
2025-11-19 23:14:07,426 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:14:07,426 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:14:07,426 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Count loan applications by hour of the day....', rows=24, cols=2
2025-11-19 23:14:07,436 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:14:11,947 - core.llm_manager - INFO - Generated response in 4.51s, tokens: 984
2025-11-19 23:14:11,948 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 2637 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:14:11,948 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=3, recommendations=2, confidence=1.00
2025-11-19 23:14:11,948 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=3
2025-11-19 23:14:11,949 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:14:13,343 - core.llm_manager - INFO - Generated response in 1.39s, tokens: 379
2025-11-19 23:14:15,184 - core.llm_manager - INFO - Generated response in 1.84s, tokens: 1105
2025-11-19 23:14:15,743 - core.llm_manager - INFO - Generated response in 0.56s, tokens: 54
2025-11-19 23:14:16,313 - core.llm_manager - INFO - Generated response in 0.57s, tokens: 63
2025-11-19 23:14:16,882 - core.llm_manager - INFO - Generated response in 0.57s, tokens: 57
2025-11-19 23:14:17,235 - core.llm_manager - INFO - Generated response in 0.35s, tokens: 62
2025-11-19 23:14:17,878 - core.llm_manager - INFO - Generated response in 0.64s, tokens: 58
2025-11-19 23:14:18,539 - core.llm_manager - INFO - Generated response in 0.66s, tokens: 69
2025-11-19 23:14:18,541 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:14:18,551 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...PPR_PROCESS_START ORDER BY COUNT(SK_ID_CURR) DESC; LIMIT 100
                                                              ^

[SQL: SELECT HOUR_APPR_PROCESS_START, COUNT(SK_ID_CURR) FROM application_train GROUP BY HOUR_APPR_PROCESS_START ORDER BY COUNT(SK_ID_CURR) DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:14:18,551 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...PPR_PROCESS_START ORDER BY COUNT(SK_ID_CURR) DESC; LIMIT 100
                                                              ^

[SQL: SELECT HOUR_APPR_PROCESS_START, COUNT(SK_ID_CURR) FROM application_train GROUP BY HOUR_APPR_PROCESS_START ORDER BY COUNT(SK_ID_CURR) DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:14:18,552 - __main__ - INFO - 
[6/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–∞–∫ –≤ —Å—Ä–µ–¥–Ω–µ–º –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫—Ä–µ–¥–∏—Ç–∞–º –¥–ª—è –ø—Ä–æ—à–ª—ã—Ö...
2025-11-19 23:14:18,552 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–∞–∫ –≤ —Å—Ä–µ–¥–Ω–µ–º –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫—Ä–µ–¥–∏—Ç–∞–º –¥–ª—è –ø—Ä–æ—à–ª—ã—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä...'
2025-11-19 23:14:18,552 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:14:19,464 - core.llm_manager - INFO - Generated response in 0.91s, tokens: 130
2025-11-19 23:14:19,466 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'On average, how does the initial down payment for previous loans of medium size ($10,000‚Äì$50,000) va...'
2025-11-19 23:14:19,466 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:14:19,466 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:14:20,486 - core.llm_manager - INFO - Generated response in 1.02s, tokens: 247
2025-11-19 23:14:20,486 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:14:20,487 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: SELECT AVG(down_payment) AS average_down_payment, sales_channel FROM loans WHERE loan_size BETWEEN 1...
2025-11-19 23:14:20,487 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'SELECT AVG(down_payment) AS average_down_payment, sales_channel FROM loans WHERE loan_size BETWEEN 1...'
2025-11-19 23:14:20,487 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:14:20,489 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'SELECT AVG(down_payment) AS average_down_payment, sales_channel FROM loans WHERE loan_size BETWEEN 1...'
2025-11-19 23:14:20,489 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 56.68it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 73.49it/s]
2025-11-19 23:14:20,578 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:14:20,578 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'SELECT AVG(down_payment) AS average_down_payment, sales_channel FROM loans WHERE loan_size BETWEEN 1...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 95.89it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 86.42it/s]
2025-11-19 23:14:20,637 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:14:21,300 - core.llm_manager - INFO - Generated response in 0.66s, tokens: 15986
2025-11-19 23:14:21,320 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.74s after 0 retries
2025-11-19 23:14:21,320 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:14:21,320 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:14:22,899 - core.database_adapter - INFO - Query executed in 1.58s, returned 7 rows
2025-11-19 23:14:22,900 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 7 rows in 1.58s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 76.13it/s]
2025-11-19 23:14:22,936 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:14:22,937 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:14:22,937 - core.enhanced_rag_system - INFO - Learned from query execution: 7 rows in 1.58s
2025-11-19 23:14:22,937 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:14:22,937 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 2.45s
2025-11-19 23:14:22,937 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=7, time=1.58s
2025-11-19 23:14:22,937 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:14:22,937 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=7, cols=2, question='SELECT AVG(down_payment) AS average_down_payment, sales_chan...'
2025-11-19 23:14:22,938 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:14:23,008 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:14:23,008 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:14:23,009 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpl8ruju1j.
2025-11-19 23:14:23,009 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:14:23,009 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpipjh3xq9.
2025-11-19 23:14:23,018 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:14:23,018 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpipjh3xq9
2025-11-19 23:14:23,709 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpl8ruju1j/index.html
2025-11-19 23:14:23,710 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:14:26,098 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:14:26,099 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:14:26,099 - kaleido.kaleido - INFO - Got F834
2025-11-19 23:14:26,099 - kaleido._kaleido_tab - INFO - Processing channel_type_by_average_down_payment.png
2025-11-19 23:14:26,099 - kaleido._kaleido_tab - INFO - Sending big command for channel_type_by_average_down_payment.png.
2025-11-19 23:14:26,280 - kaleido._kaleido_tab - INFO - Sent big command for channel_type_by_average_down_payment.png.
2025-11-19 23:14:26,285 - kaleido.kaleido - INFO - Reloading tab F834 before return.
2025-11-19 23:14:26,527 - kaleido.kaleido - INFO - Putting tab F834 back (queue size: 0).
2025-11-19 23:14:26,528 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:14:26,528 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:14:26,528 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:14:26,533 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:14:26,534 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:26,534 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:26,534 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:14:26,534 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:14:26,703 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:26,703 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:26,703 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:26,704 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:26,704 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:14:26,704 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:14:26,707 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=40650 bytes
2025-11-19 23:14:26,707 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:14:26,707 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:14:26,708 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='SELECT AVG(down_payment) AS average_down_payment, sales_chan...', rows=7, cols=2
2025-11-19 23:14:26,713 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:14:28,939 - core.llm_manager - INFO - Generated response in 2.22s, tokens: 745
2025-11-19 23:14:28,939 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 1473 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:14:28,939 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=1, recommendations=2, confidence=0.79
2025-11-19 23:14:28,940 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=1
2025-11-19 23:14:28,941 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:14:30,377 - core.llm_manager - INFO - Generated response in 1.44s, tokens: 376
2025-11-19 23:14:31,791 - core.llm_manager - INFO - Generated response in 1.41s, tokens: 755
2025-11-19 23:14:32,249 - core.llm_manager - INFO - Generated response in 0.46s, tokens: 60
2025-11-19 23:14:32,651 - core.llm_manager - INFO - Generated response in 0.40s, tokens: 62
2025-11-19 23:14:33,963 - core.llm_manager - INFO - Generated response in 1.31s, tokens: 58
2025-11-19 23:14:34,697 - core.llm_manager - INFO - Generated response in 0.73s, tokens: 116
2025-11-19 23:14:34,697 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:14:34,701 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...Y CHANNEL_TYPE ORDER BY avg_amt_down_payment DESC; LIMIT 100
                                                              ^

[SQL: SELECT CHANNEL_TYPE AS group_key, AVG(AMT_DOWN_PAYMENT) AS avg_amt_down_payment FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY CHANNEL_TYPE ORDER BY avg_amt_down_payment DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:14:34,701 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...Y CHANNEL_TYPE ORDER BY avg_amt_down_payment DESC; LIMIT 100
                                                              ^

[SQL: SELECT CHANNEL_TYPE AS group_key, AVG(AMT_DOWN_PAYMENT) AS avg_amt_down_payment FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY CHANNEL_TYPE ORDER BY avg_amt_down_payment DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:14:34,701 - __main__ - INFO - 
[7/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –°–¥–µ–ª–∞–π—Ç–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ä–µ–∑ –ø–æ credit_card_balance: –¥–ª—è –∫–∞—Ä—Ç –±–µ–∑ —Ç–µ–∫—É—â–µ–≥–æ –æ—Å—Ç–∞—Ç...
2025-11-19 23:14:34,702 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–°–¥–µ–ª–∞–π—Ç–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ä–µ–∑ –ø–æ credit_card_balance: –¥–ª—è –∫–∞—Ä—Ç –±–µ–∑ —Ç–µ–∫—É—â–µ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞ (AMT_BALANCE = 0)...'
2025-11-19 23:14:34,702 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:14:35,154 - core.llm_manager - INFO - Generated response in 0.45s, tokens: 135
2025-11-19 23:14:35,155 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Create an aggregated slice for credit_card_balance: for cards with no current balance (AMT_BALANCE =...'
2025-11-19 23:14:35,155 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:14:35,155 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:14:37,731 - core.llm_manager - INFO - Generated response in 2.58s, tokens: 254
2025-11-19 23:14:37,731 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:14:37,731 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: SELECT MONTHS_BALANCE, AVG(AMT_PAYMENT_CURRENT) FROM credit_card_balance WHERE AMT_BALANCE = 0 GROUP...
2025-11-19 23:14:37,731 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'SELECT MONTHS_BALANCE, AVG(AMT_PAYMENT_CURRENT) FROM credit_card_balance WHERE AMT_BALANCE = 0 GROUP...'
2025-11-19 23:14:37,731 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:14:37,732 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'SELECT MONTHS_BALANCE, AVG(AMT_PAYMENT_CURRENT) FROM credit_card_balance WHERE AMT_BALANCE = 0 GROUP...'
2025-11-19 23:14:37,732 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 191.07it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 186.20it/s]
2025-11-19 23:14:37,768 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:14:37,769 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'SELECT MONTHS_BALANCE, AVG(AMT_PAYMENT_CURRENT) FROM credit_card_balance WHERE AMT_BALANCE = 0 GROUP...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 177.72it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 194.15it/s]
2025-11-19 23:14:37,796 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:14:38,852 - core.llm_manager - INFO - Generated response in 1.05s, tokens: 1759
2025-11-19 23:14:38,865 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 1.10s after 0 retries
2025-11-19 23:14:38,865 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:14:38,865 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:14:43,264 - core.database_adapter - INFO - Query executed in 4.40s, returned 96 rows
2025-11-19 23:14:43,264 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 96 rows in 4.40s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 165.23it/s]
2025-11-19 23:14:43,296 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:14:43,296 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:14:43,296 - core.enhanced_rag_system - INFO - Learned from query execution: 96 rows in 4.40s
2025-11-19 23:14:43,296 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:14:43,296 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 5.56s
2025-11-19 23:14:43,296 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=96, time=4.40s
2025-11-19 23:14:43,296 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:14:43,297 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=96, cols=2, question='SELECT MONTHS_BALANCE, AVG(AMT_PAYMENT_CURRENT) FROM credit_...'
2025-11-19 23:14:43,297 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:14:43,321 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:43,321 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:43,321 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:43,321 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:43,363 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:14:43,364 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:14:43,364 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmp9ms3nioo.
2025-11-19 23:14:43,364 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:14:43,365 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpd8q3bu5l.
2025-11-19 23:14:43,384 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:14:43,384 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpd8q3bu5l
2025-11-19 23:14:44,022 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmp9ms3nioo/index.html
2025-11-19 23:14:44,024 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:14:46,236 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:14:46,237 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:14:46,237 - kaleido.kaleido - INFO - Got 2E17
2025-11-19 23:14:46,238 - kaleido._kaleido_tab - INFO - Processing avg_amt_payment_current_by_months_balance.png
2025-11-19 23:14:46,238 - kaleido._kaleido_tab - INFO - Sending big command for avg_amt_payment_current_by_months_balance.png.
2025-11-19 23:14:46,442 - kaleido._kaleido_tab - INFO - Sent big command for avg_amt_payment_current_by_months_balance.png.
2025-11-19 23:14:46,443 - kaleido.kaleido - INFO - Reloading tab 2E17 before return.
2025-11-19 23:14:46,684 - kaleido.kaleido - INFO - Putting tab 2E17 back (queue size: 0).
2025-11-19 23:14:46,684 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:14:46,684 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:14:46,684 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:14:46,686 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:14:46,687 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:46,687 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:46,687 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:14:46,687 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:14:46,856 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:46,860 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:46,860 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:14:46,861 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:14:46,861 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:14:46,861 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:14:46,864 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=46178 bytes
2025-11-19 23:14:46,864 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:14:46,864 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:14:46,864 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='SELECT MONTHS_BALANCE, AVG(AMT_PAYMENT_CURRENT) FROM credit_...', rows=96, cols=2
2025-11-19 23:14:46,872 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:14:49,773 - core.llm_manager - INFO - Generated response in 2.90s, tokens: 920
2025-11-19 23:14:49,774 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 2174 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:14:49,774 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=5, recommendations=2, confidence=1.00
2025-11-19 23:14:49,774 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=5
2025-11-19 23:14:49,775 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:14:51,958 - core.llm_manager - INFO - Generated response in 2.18s, tokens: 379
2025-11-19 23:14:54,038 - core.llm_manager - INFO - Generated response in 2.08s, tokens: 952
2025-11-19 23:14:54,406 - core.llm_manager - INFO - Generated response in 0.37s, tokens: 60
2025-11-19 23:14:55,277 - core.llm_manager - INFO - Generated response in 0.87s, tokens: 59
2025-11-19 23:14:55,918 - core.llm_manager - INFO - Generated response in 0.64s, tokens: 63
2025-11-19 23:14:56,840 - core.llm_manager - INFO - Generated response in 0.92s, tokens: 62
2025-11-19 23:14:57,546 - core.llm_manager - INFO - Generated response in 0.71s, tokens: 75
2025-11-19 23:14:58,298 - core.llm_manager - INFO - Generated response in 0.75s, tokens: 67
2025-11-19 23:14:58,970 - core.llm_manager - INFO - Generated response in 0.67s, tokens: 70
2025-11-19 23:14:59,400 - core.llm_manager - INFO - Generated response in 0.43s, tokens: 107
2025-11-19 23:14:59,400 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:14:59,403 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...THS_BALANCE ORDER BY avg_amt_payment_current DESC; LIMIT 100
                                                              ^

[SQL: SELECT MONTHS_BALANCE AS group_key, AVG(AMT_PAYMENT_CURRENT) AS avg_amt_payment_current FROM credit_card_balance WHERE AMT_BALANCE = 0 GROUP BY MONTHS_BALANCE ORDER BY avg_amt_payment_current DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:14:59,404 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...THS_BALANCE ORDER BY avg_amt_payment_current DESC; LIMIT 100
                                                              ^

[SQL: SELECT MONTHS_BALANCE AS group_key, AVG(AMT_PAYMENT_CURRENT) AS avg_amt_payment_current FROM credit_card_balance WHERE AMT_BALANCE = 0 GROUP BY MONTHS_BALANCE ORDER BY avg_amt_payment_current DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:14:59,404 - __main__ - INFO - 
[8/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –í —Å—Ä–µ–¥–Ω–µ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –ª—é–¥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–≤–æ–∏ –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ –∫–∞—Ä—Ç–∞–º?...
2025-11-19 23:14:59,405 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–í —Å—Ä–µ–¥–Ω–µ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –ª—é–¥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–≤–æ–∏ –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ –∫–∞—Ä—Ç–∞–º?...'
2025-11-19 23:14:59,405 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:14:59,932 - core.llm_manager - INFO - Generated response in 0.53s, tokens: 66
2025-11-19 23:14:59,933 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'On average, how much do people use their credit card limits?...'
2025-11-19 23:14:59,933 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:14:59,933 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:15:00,705 - core.llm_manager - INFO - Generated response in 0.77s, tokens: 196
2025-11-19 23:15:00,706 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:15:00,706 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the average credit card utilization rate across all users....
2025-11-19 23:15:00,706 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the average credit card utilization rate across all users....'
2025-11-19 23:15:00,707 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:15:00,707 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the average credit card utilization rate across all users....'
2025-11-19 23:15:00,707 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 72.21it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 185.53it/s]
2025-11-19 23:15:00,756 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:15:00,756 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the average credit card utilization rate across all users....' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.26it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 195.87it/s]
2025-11-19 23:15:00,795 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:15:01,518 - core.llm_manager - INFO - Generated response in 0.72s, tokens: 2238
2025-11-19 23:15:01,526 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.77s after 0 retries
2025-11-19 23:15:01,526 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:15:01,526 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:15:01,533 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.DivisionByZero) division by zero

[SQL: SELECT AVG(CAST(amt_balance AS numeric) / CAST(amt_credit_limit_actual AS numeric)) AS avg_utilization_rate FROM credit_card_balance WHERE amt_credit_limit_actual IS NOT NULL AND amt_balance IS NOT NULL LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-19 23:15:01,534 - agents.enhanced_sql_agent - ERROR - [ENHANCED_SQL_AGENT] Error processing question: (psycopg2.errors.DivisionByZero) division by zero

[SQL: SELECT AVG(CAST(amt_balance AS numeric) / CAST(amt_credit_limit_actual AS numeric)) AS avg_utilization_rate FROM credit_card_balance WHERE amt_credit_limit_actual IS NOT NULL AND amt_balance IS NOT NULL LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DivisionByZero: division by zero


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dark/Documents/GitHub/SQL_Agent_proj/agents/enhanced_sql_agent.py", line 221, in process_question
    data = self.db_adapter.execute_query(optimized_sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/Documents/GitHub/SQL_Agent_proj/core/database_adapter.py", line 250, in execute_query
    result = pd.read_sql_query(query, conn)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/pandas/io/sql.py", line 486, in read_sql_query
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/pandas/io/sql.py", line 1776, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/pandas/io/sql.py", line 1599, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1778, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/dark/.local/share/mamba/envs/sqltg/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.DivisionByZero) division by zero

[SQL: SELECT AVG(CAST(amt_balance AS numeric) / CAST(amt_credit_limit_actual AS numeric)) AS avg_utilization_rate FROM credit_card_balance WHERE amt_credit_limit_actual IS NOT NULL AND amt_balance IS NOT NULL LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-19 23:15:01,543 - agents.orchestrator - ERROR - [ORCHESTRATOR] SQL generation failed: (psycopg2.errors.DivisionByZero) division by zero

[SQL: SELECT AVG(CAST(amt_balance AS numeric) / CAST(amt_credit_limit_actual AS numeric)) AS avg_utilization_rate FROM credit_card_balance WHERE amt_credit_limit_actual IS NOT NULL AND amt_balance IS NOT NULL LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-19 23:15:01,544 - __main__ - INFO - 
[9/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–∞–∫–æ–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é/–Ω–∞–∏–º–µ–Ω—å—à—É—é —á–∞—Å—Ç–æ—Ç—É –æ–¥–æ–±—Ä–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–∫–∞...
2025-11-19 23:15:01,544 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–∞–∫–æ–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é/–Ω–∞–∏–º–µ–Ω—å—à—É—é —á–∞—Å—Ç–æ—Ç—É –æ–¥–æ–±—Ä–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–∫–∞–∑–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç–Ω—ã–º –∑–∞—è–≤...'
2025-11-19 23:15:01,544 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:15:02,230 - core.llm_manager - INFO - Generated response in 0.69s, tokens: 83
2025-11-19 23:15:02,231 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Which day of the week shows the highest/lowest frequency of credit application approval or rejection...'
2025-11-19 23:15:02,231 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:15:02,231 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:15:02,907 - core.llm_manager - INFO - Generated response in 0.68s, tokens: 254
2025-11-19 23:15:02,908 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:15:02,908 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: For each day of the week, calculate the count of credit applications approved and the count of credi...
2025-11-19 23:15:02,908 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'For each day of the week, calculate the count of credit applications approved and the count of credi...'
2025-11-19 23:15:02,908 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:15:02,908 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'For each day of the week, calculate the count of credit applications approved and the count of credi...'
2025-11-19 23:15:02,908 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.24it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 162.52it/s]
2025-11-19 23:15:02,945 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:15:02,946 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'For each day of the week, calculate the count of credit applications approved and the count of credi...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 168.68it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 191.58it/s]
2025-11-19 23:15:02,977 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:15:05,132 - core.llm_manager - INFO - Generated response in 2.15s, tokens: 4690
2025-11-19 23:15:05,143 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 2.20s after 0 retries
2025-11-19 23:15:05,143 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:15:05,143 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:15:07,785 - core.database_adapter - INFO - Query executed in 2.64s, returned 4 rows
2025-11-19 23:15:07,785 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 4 rows in 2.64s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 110.21it/s]
2025-11-19 23:15:07,814 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:15:07,814 - core.dynamic_semantic_layer - INFO - Learned from query: 6 tables, feedback: None
2025-11-19 23:15:07,814 - core.enhanced_rag_system - INFO - Learned from query execution: 4 rows in 2.64s
2025-11-19 23:15:07,815 - core.dynamic_semantic_layer - INFO - Learned from query: 6 tables, feedback: successful
2025-11-19 23:15:07,815 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 4.91s
2025-11-19 23:15:07,815 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=4, time=2.64s
2025-11-19 23:15:07,815 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:15:07,815 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=4, cols=3, question='For each day of the week, calculate the count of credit appl...'
2025-11-19 23:15:07,815 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:15:07,867 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:15:07,868 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:15:07,868 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpdlg4dbxs.
2025-11-19 23:15:07,868 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:15:07,869 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmp000lc9b5.
2025-11-19 23:15:07,880 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:15:07,880 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmp000lc9b5
2025-11-19 23:15:08,467 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpdlg4dbxs/index.html
2025-11-19 23:15:08,467 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:15:10,695 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:15:10,696 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:15:10,696 - kaleido.kaleido - INFO - Got E3CA
2025-11-19 23:15:10,696 - kaleido._kaleido_tab - INFO - Processing weekday_appr_process_start_by_category.png
2025-11-19 23:15:10,696 - kaleido._kaleido_tab - INFO - Sending big command for weekday_appr_process_start_by_category.png.
2025-11-19 23:15:10,839 - kaleido._kaleido_tab - INFO - Sent big command for weekday_appr_process_start_by_category.png.
2025-11-19 23:15:10,839 - kaleido.kaleido - INFO - Reloading tab E3CA before return.
2025-11-19 23:15:11,022 - kaleido.kaleido - INFO - Putting tab E3CA back (queue size: 0).
2025-11-19 23:15:11,022 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:15:11,022 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:15:11,022 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:15:11,024 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:15:11,024 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:11,025 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:11,025 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:15:11,025 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:15:11,249 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:11,249 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:11,249 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:11,249 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:11,250 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:15:11,250 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:15:11,253 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=30285 bytes
2025-11-19 23:15:11,254 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:15:11,254 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:15:11,254 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='For each day of the week, calculate the count of credit appl...', rows=4, cols=3
2025-11-19 23:15:11,257 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:15:12,546 - core.llm_manager - INFO - Generated response in 1.28s, tokens: 1019
2025-11-19 23:15:12,546 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 1039 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:15:12,546 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=0, recommendations=2, confidence=0.70
2025-11-19 23:15:12,547 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=0
2025-11-19 23:15:12,547 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:15:13,938 - core.llm_manager - INFO - Generated response in 1.39s, tokens: 380
2025-11-19 23:15:15,987 - core.llm_manager - INFO - Generated response in 2.05s, tokens: 569
2025-11-19 23:15:17,034 - core.llm_manager - INFO - Generated response in 1.05s, tokens: 62
2025-11-19 23:15:17,602 - core.llm_manager - INFO - Generated response in 0.57s, tokens: 58
2025-11-19 23:15:18,982 - core.llm_manager - INFO - Generated response in 1.38s, tokens: 155
2025-11-19 23:15:18,982 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:15:18,984 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...Y_APPR_PROCESS_START ORDER BY approved_count DESC; LIMIT 100
                                                              ^

[SQL: SELECT WEEKDAY_APPR_PROCESS_START, SUM(CASE WHEN NAME_CONTRACT_STATUS = 'Approved' THEN 1 ELSE 0 END) AS approved_count, SUM(CASE WHEN NAME_CONTRACT_STATUS = 'Refused' THEN 1 ELSE 0 END) AS refused_count FROM previous_application GROUP BY WEEKDAY_APPR_PROCESS_START ORDER BY approved_count DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:15:18,984 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...Y_APPR_PROCESS_START ORDER BY approved_count DESC; LIMIT 100
                                                              ^

[SQL: SELECT WEEKDAY_APPR_PROCESS_START, SUM(CASE WHEN NAME_CONTRACT_STATUS = 'Approved' THEN 1 ELSE 0 END) AS approved_count, SUM(CASE WHEN NAME_CONTRACT_STATUS = 'Refused' THEN 1 ELSE 0 END) AS refused_count FROM previous_application GROUP BY WEEKDAY_APPR_PROCESS_START ORDER BY approved_count DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:15:18,984 - __main__ - INFO - 
[10/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–∞–∫–æ–≤–∞ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º —É—Ä–æ–≤–Ω–µ –¥–æ—Ö–æ–¥–∞ (AMT_INCOME_TOTAL) –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏, —Å–∫–ª–æ–Ω...
2025-11-19 23:15:18,984 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–∞–∫–æ–≤–∞ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º —É—Ä–æ–≤–Ω–µ –¥–æ—Ö–æ–¥–∞ (AMT_INCOME_TOTAL) –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏, —Å–∫–ª–æ–Ω–Ω—ã–º–∏ –∫ –¥–µ—Ñ–æ–ª—Ç—É, –∏ —Ç–µ...'
2025-11-19 23:15:18,985 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:15:19,482 - core.llm_manager - INFO - Generated response in 0.50s, tokens: 95
2025-11-19 23:15:19,483 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'What is the difference in the average income level (AMT_INCOME_TOTAL) between customers prone to def...'
2025-11-19 23:15:19,483 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:15:19,483 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:15:20,040 - core.llm_manager - INFO - Generated response in 0.56s, tokens: 231
2025-11-19 23:15:20,041 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:15:20,041 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the average AMT_INCOME_TOTAL for customers categorized as prone to default and for custome...
2025-11-19 23:15:20,041 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the average AMT_INCOME_TOTAL for customers categorized as prone to default and for custome...'
2025-11-19 23:15:20,041 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:15:20,041 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the average AMT_INCOME_TOTAL for customers categorized as prone to default and for custome...'
2025-11-19 23:15:20,041 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.20it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 187.98it/s]
2025-11-19 23:15:20,090 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:15:20,090 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the average AMT_INCOME_TOTAL for customers categorized as prone to default and for custome...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 196.05it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 178.18it/s]
2025-11-19 23:15:20,132 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:15:22,534 - core.llm_manager - INFO - Generated response in 2.40s, tokens: 15426
2025-11-19 23:15:22,544 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 2.45s after 0 retries
2025-11-19 23:15:22,544 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:15:22,544 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:15:22,986 - core.database_adapter - INFO - Query executed in 0.44s, returned 2 rows
2025-11-19 23:15:22,986 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 2 rows in 0.44s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 61.17it/s]
2025-11-19 23:15:23,036 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:15:23,036 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:15:23,036 - core.enhanced_rag_system - INFO - Learned from query execution: 2 rows in 0.44s
2025-11-19 23:15:23,037 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:15:23,037 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 3.00s
2025-11-19 23:15:23,037 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=2, time=0.44s
2025-11-19 23:15:23,038 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:15:23,038 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=2, cols=2, question='Calculate the average AMT_INCOME_TOTAL for customers categor...'
2025-11-19 23:15:23,038 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:15:23,051 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:23,051 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:23,052 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:23,052 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:23,100 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:15:23,100 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:15:23,101 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpub4jiv65.
2025-11-19 23:15:23,102 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:15:23,104 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpiz5t1yn_.
2025-11-19 23:15:23,114 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:15:23,114 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpiz5t1yn_
2025-11-19 23:15:23,640 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpub4jiv65/index.html
2025-11-19 23:15:23,641 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:15:26,039 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:15:26,040 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:15:26,040 - kaleido.kaleido - INFO - Got 1099
2025-11-19 23:15:26,040 - kaleido._kaleido_tab - INFO - Processing average_income_by_default_category.png
2025-11-19 23:15:26,040 - kaleido._kaleido_tab - INFO - Sending big command for average_income_by_default_category.png.
2025-11-19 23:15:26,262 - kaleido._kaleido_tab - INFO - Sent big command for average_income_by_default_category.png.
2025-11-19 23:15:26,264 - kaleido.kaleido - INFO - Reloading tab 1099 before return.
2025-11-19 23:15:26,485 - kaleido.kaleido - INFO - Putting tab 1099 back (queue size: 0).
2025-11-19 23:15:26,485 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:15:26,485 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:15:26,485 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:15:26,497 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:15:26,497 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:26,497 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:26,497 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:15:26,497 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:15:26,671 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:26,671 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:26,671 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:26,675 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:26,675 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:15:26,675 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:15:26,680 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=28321 bytes
2025-11-19 23:15:26,680 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:15:26,680 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:15:26,680 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate the average AMT_INCOME_TOTAL for customers categor...', rows=2, cols=2
2025-11-19 23:15:26,686 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:15:28,609 - core.llm_manager - INFO - Generated response in 1.92s, tokens: 525
2025-11-19 23:15:28,610 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 905 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:15:28,610 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=0, recommendations=2, confidence=0.70
2025-11-19 23:15:28,611 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=0
2025-11-19 23:15:28,612 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:15:29,556 - core.llm_manager - INFO - Generated response in 0.94s, tokens: 366
2025-11-19 23:15:30,770 - core.llm_manager - INFO - Generated response in 1.21s, tokens: 486
2025-11-19 23:15:31,992 - core.llm_manager - INFO - Generated response in 1.22s, tokens: 62
2025-11-19 23:15:32,408 - core.llm_manager - INFO - Generated response in 0.42s, tokens: 58
2025-11-19 23:15:32,820 - core.llm_manager - INFO - Generated response in 0.41s, tokens: 111
2025-11-19 23:15:32,820 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:15:32,824 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...OTAL) FROM application_train_test GROUP BY TARGET; LIMIT 100
                                                              ^

[SQL: SELECT TARGET, AVG(AMT_INCOME_TOTAL) FROM application_train_test GROUP BY TARGET; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:15:32,824 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...OTAL) FROM application_train_test GROUP BY TARGET; LIMIT 100
                                                              ^

[SQL: SELECT TARGET, AVG(AMT_INCOME_TOTAL) FROM application_train_test GROUP BY TARGET; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:15:32,824 - __main__ - INFO - üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 10/20 | –°—Ä–∞–±–æ—Ç–∞–ª–æ: 9 (90.0%) | –í—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å: 9 (90.0%) | –ü–æ—Ö–æ–∂–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 (0.0%) | –û—Å—Ç–∞–ª–æ—Å—å: ~4.2 –º–∏–Ω
2025-11-19 23:15:32,824 - __main__ - INFO - 
[11/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ü–æ —Ç–∞–±–ª–∏—Ü–µ previous_application —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –∞–Ω–Ω—É–∏—Ç–µ—Ç–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ ...
2025-11-19 23:15:32,824 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ü–æ —Ç–∞–±–ª–∏—Ü–µ previous_application —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –∞–Ω–Ω—É–∏—Ç–µ—Ç–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫—Ä–µ–¥–∏—Ç...'
2025-11-19 23:15:32,824 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:15:38,427 - core.llm_manager - INFO - Generated response in 5.60s, tokens: 155
2025-11-19 23:15:38,427 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Using the `previous_application` table, calculate the average annuity payment for previous loans for...'
2025-11-19 23:15:38,427 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:15:38,427 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:15:39,462 - core.llm_manager - INFO - Generated response in 1.03s, tokens: 265
2025-11-19 23:15:39,463 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:15:39,463 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: SELECT NAME_PRODUCT_TYPE, AVG(AMT_ANNUITY) FROM previous_application WHERE AMT_APPLICATION > AMT_CRE...
2025-11-19 23:15:39,463 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'SELECT NAME_PRODUCT_TYPE, AVG(AMT_ANNUITY) FROM previous_application WHERE AMT_APPLICATION > AMT_CRE...'
2025-11-19 23:15:39,463 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:15:39,463 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'SELECT NAME_PRODUCT_TYPE, AVG(AMT_ANNUITY) FROM previous_application WHERE AMT_APPLICATION > AMT_CRE...'
2025-11-19 23:15:39,463 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 81.94it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 181.43it/s]
2025-11-19 23:15:39,505 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:15:39,505 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'SELECT NAME_PRODUCT_TYPE, AVG(AMT_ANNUITY) FROM previous_application WHERE AMT_APPLICATION > AMT_CRE...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 172.05it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 185.42it/s]
2025-11-19 23:15:39,537 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:15:45,336 - core.llm_manager - INFO - Generated response in 5.80s, tokens: 4015
2025-11-19 23:15:45,342 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 5.84s after 0 retries
2025-11-19 23:15:45,342 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:15:45,342 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:15:46,542 - core.database_adapter - INFO - Query executed in 1.20s, returned 2 rows
2025-11-19 23:15:46,542 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 2 rows in 1.20s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.61it/s]
2025-11-19 23:15:46,581 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:15:46,581 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:15:46,581 - core.enhanced_rag_system - INFO - Learned from query execution: 2 rows in 1.20s
2025-11-19 23:15:46,581 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:15:46,581 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 7.12s
2025-11-19 23:15:46,582 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=2, time=1.20s
2025-11-19 23:15:46,582 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:15:46,584 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=2, cols=2, question='SELECT NAME_PRODUCT_TYPE, AVG(AMT_ANNUITY) FROM previous_app...'
2025-11-19 23:15:46,584 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:15:46,642 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:15:46,643 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:15:46,643 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpovihfwfz.
2025-11-19 23:15:46,643 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:15:46,644 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpiciqitbl.
2025-11-19 23:15:46,653 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:15:46,654 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpiciqitbl
2025-11-19 23:15:47,139 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpovihfwfz/index.html
2025-11-19 23:15:47,139 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:15:49,280 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:15:49,281 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:15:49,281 - kaleido.kaleido - INFO - Got DCA9
2025-11-19 23:15:49,281 - kaleido._kaleido_tab - INFO - Processing avg_amt_annuity_by_name_product_type.png
2025-11-19 23:15:49,281 - kaleido._kaleido_tab - INFO - Sending big command for avg_amt_annuity_by_name_product_type.png.
2025-11-19 23:15:49,407 - kaleido._kaleido_tab - INFO - Sent big command for avg_amt_annuity_by_name_product_type.png.
2025-11-19 23:15:49,408 - kaleido.kaleido - INFO - Reloading tab DCA9 before return.
2025-11-19 23:15:49,583 - kaleido.kaleido - INFO - Putting tab DCA9 back (queue size: 0).
2025-11-19 23:15:49,583 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:15:49,583 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:15:49,583 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:15:49,586 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:15:49,586 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:49,586 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:49,586 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:15:49,586 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:15:49,812 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:49,812 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:49,812 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:49,813 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:49,813 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:15:49,813 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:15:49,816 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=27878 bytes
2025-11-19 23:15:49,816 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:15:49,816 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:15:49,816 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='SELECT NAME_PRODUCT_TYPE, AVG(AMT_ANNUITY) FROM previous_app...', rows=2, cols=2
2025-11-19 23:15:49,822 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:15:50,672 - core.llm_manager - INFO - Generated response in 0.85s, tokens: 422
2025-11-19 23:15:50,672 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 523 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:15:50,672 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=0, recommendations=2, confidence=0.70
2025-11-19 23:15:50,673 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=0
2025-11-19 23:15:50,673 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:15:51,731 - core.llm_manager - INFO - Generated response in 1.06s, tokens: 354
2025-11-19 23:15:52,866 - core.llm_manager - INFO - Generated response in 1.13s, tokens: 280
2025-11-19 23:15:53,286 - core.llm_manager - INFO - Generated response in 0.42s, tokens: 62
2025-11-19 23:15:54,403 - core.llm_manager - INFO - Generated response in 1.11s, tokens: 58
2025-11-19 23:15:54,849 - core.llm_manager - INFO - Generated response in 0.45s, tokens: 113
2025-11-19 23:15:54,849 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:15:54,855 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...Y NAME_PRODUCT_TYPE ORDER BY avg_amt_annuity DESC; LIMIT 100
                                                              ^

[SQL: SELECT NAME_PRODUCT_TYPE AS group_key, AVG(AMT_ANNUITY) AS avg_amt_annuity FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_PRODUCT_TYPE ORDER BY avg_amt_annuity DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:15:54,855 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...Y NAME_PRODUCT_TYPE ORDER BY avg_amt_annuity DESC; LIMIT 100
                                                              ^

[SQL: SELECT NAME_PRODUCT_TYPE AS group_key, AVG(AMT_ANNUITY) AS avg_amt_annuity FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_PRODUCT_TYPE ORDER BY avg_amt_annuity DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:15:54,856 - __main__ - INFO - 
[12/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–∞–∫ –≤ —Å—Ä–µ–¥–Ω–µ–º –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –∞–Ω–Ω—É–∏—Ç–µ—Ç–Ω—ã–π –ø–ª–∞—Ç—ë–∂ –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫—Ä–µ–¥–∏—Ç–∞–º –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–∏...
2025-11-19 23:15:54,856 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–∞–∫ –≤ —Å—Ä–µ–¥–Ω–µ–º –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –∞–Ω–Ω—É–∏—Ç–µ—Ç–Ω—ã–π –ø–ª–∞—Ç—ë–∂ –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫—Ä–µ–¥–∏—Ç–∞–º –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞—è–≤–æ–∫ –ø—Ä–∏–º–µ—Ä–Ω–æ –∑–∞...'
2025-11-19 23:15:54,856 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:15:55,653 - core.llm_manager - INFO - Generated response in 0.80s, tokens: 127
2025-11-19 23:15:55,653 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'How does the annuity payment on previous loans for previous applications change on average over the ...'
2025-11-19 23:15:55,653 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:15:55,653 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:15:56,379 - core.llm_manager - INFO - Generated response in 0.73s, tokens: 282
2025-11-19 23:15:56,380 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:15:56,380 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the average annuity payment for previous loans from previous applications, grouped by clie...
2025-11-19 23:15:56,380 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the average annuity payment for previous loans from previous applications, grouped by clie...'
2025-11-19 23:15:56,380 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:15:56,382 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the average annuity payment for previous loans from previous applications, grouped by clie...'
2025-11-19 23:15:56,382 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 66.60it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 56.49it/s]
2025-11-19 23:15:56,459 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:15:56,463 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the average annuity payment for previous loans from previous applications, grouped by clie...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 100.16it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 164.34it/s]
2025-11-19 23:15:56,498 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:15:57,283 - core.llm_manager - INFO - Generated response in 0.78s, tokens: 3217
2025-11-19 23:15:57,286 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.82s after 0 retries
2025-11-19 23:15:57,286 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:15:57,287 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:15:59,047 - core.database_adapter - INFO - Query executed in 1.76s, returned 24 rows
2025-11-19 23:15:59,047 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 24 rows in 1.76s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 83.33it/s]
2025-11-19 23:15:59,081 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:15:59,081 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:15:59,081 - core.enhanced_rag_system - INFO - Learned from query execution: 24 rows in 1.76s
2025-11-19 23:15:59,081 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:15:59,081 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 2.70s
2025-11-19 23:15:59,082 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=24, time=1.76s
2025-11-19 23:15:59,082 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:15:59,082 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=24, cols=2, question='Calculate the average annuity payment for previous loans fro...'
2025-11-19 23:15:59,083 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:15:59,110 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:59,110 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:59,110 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:15:59,111 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:15:59,164 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:15:59,165 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:15:59,165 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpuv17ys6z.
2025-11-19 23:15:59,165 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:15:59,166 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpx_91j6_b.
2025-11-19 23:15:59,175 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:15:59,175 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpx_91j6_b
2025-11-19 23:15:59,744 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpuv17ys6z/index.html
2025-11-19 23:15:59,744 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:16:02,116 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:16:02,116 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:16:02,116 - kaleido.kaleido - INFO - Got C3EA
2025-11-19 23:16:02,117 - kaleido._kaleido_tab - INFO - Processing avg_annuity_by_hour_appr_process_start.png
2025-11-19 23:16:02,117 - kaleido._kaleido_tab - INFO - Sending big command for avg_annuity_by_hour_appr_process_start.png.
2025-11-19 23:16:02,312 - kaleido._kaleido_tab - INFO - Sent big command for avg_annuity_by_hour_appr_process_start.png.
2025-11-19 23:16:02,313 - kaleido.kaleido - INFO - Reloading tab C3EA before return.
2025-11-19 23:16:02,553 - kaleido.kaleido - INFO - Putting tab C3EA back (queue size: 0).
2025-11-19 23:16:02,554 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:16:02,554 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:16:02,554 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:16:02,562 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:16:02,562 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:16:02,562 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:16:02,562 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:16:02,562 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:16:02,805 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:16:02,809 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:16:02,809 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:16:02,810 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:16:02,810 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:16:02,810 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:16:02,813 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=43114 bytes
2025-11-19 23:16:02,813 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:16:02,813 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:16:02,817 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate the average annuity payment for previous loans fro...', rows=24, cols=2
2025-11-19 23:16:02,830 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:16:04,600 - core.llm_manager - INFO - Generated response in 1.76s, tokens: 866
2025-11-19 23:16:04,601 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 1772 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:16:04,602 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=3, recommendations=2, confidence=1.00
2025-11-19 23:16:04,602 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=3
2025-11-19 23:16:04,603 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:16:05,659 - core.llm_manager - INFO - Generated response in 1.06s, tokens: 393
2025-11-19 23:16:07,244 - core.llm_manager - INFO - Generated response in 1.59s, tokens: 839
2025-11-19 23:16:07,967 - core.llm_manager - INFO - Generated response in 0.72s, tokens: 63
2025-11-19 23:16:08,993 - core.llm_manager - INFO - Generated response in 1.03s, tokens: 57
2025-11-19 23:16:10,163 - core.llm_manager - INFO - Generated response in 1.17s, tokens: 74
2025-11-19 23:16:11,031 - core.llm_manager - INFO - Generated response in 0.87s, tokens: 67
2025-11-19 23:16:11,561 - core.llm_manager - INFO - Generated response in 0.53s, tokens: 67
2025-11-19 23:16:12,077 - core.llm_manager - INFO - Generated response in 0.52s, tokens: 161
2025-11-19 23:16:12,077 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:16:12,079 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ..._APPR_PROCESS_START ORDER BY avg_amt_annuity DESC; LIMIT 100
                                                              ^

[SQL: SELECT HOUR_APPR_PROCESS_START AS group_key, AVG(AMT_ANNUITY) AS avg_amt_annuity FROM previous_application WHERE DAYS_DECISION > -365 GROUP BY HOUR_APPR_PROCESS_START ORDER BY avg_amt_annuity DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:12,079 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ..._APPR_PROCESS_START ORDER BY avg_amt_annuity DESC; LIMIT 100
                                                              ^

[SQL: SELECT HOUR_APPR_PROCESS_START AS group_key, AVG(AMT_ANNUITY) AS avg_amt_annuity FROM previous_application WHERE DAYS_DECISION > -365 GROUP BY HOUR_APPR_PROCESS_START ORDER BY avg_amt_annuity DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:12,079 - __main__ - INFO - 
[13/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤ –∏–∑ –ë–ö–ò –≤ —Ä–∞–∑—Ä–µ–∑–µ –≥...
2025-11-19 23:16:12,082 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤ –∏–∑ –ë–ö–ò –≤ —Ä–∞–∑—Ä–µ–∑–µ –≥–µ–Ω–¥–µ—Ä–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞...'
2025-11-19 23:16:12,082 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:16:12,945 - core.llm_manager - INFO - Generated response in 0.86s, tokens: 88
2025-11-19 23:16:12,945 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Provide an analysis of the distribution of active and closed loans from credit bureaus, broken down ...'
2025-11-19 23:16:12,945 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:16:12,945 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:16:13,704 - core.llm_manager - INFO - Generated response in 0.76s, tokens: 251
2025-11-19 23:16:13,704 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:16:13,704 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CA...
2025-11-19 23:16:13,704 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CA...'
2025-11-19 23:16:13,704 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:16:13,705 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CA...'
2025-11-19 23:16:13,705 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 96.60it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 141.58it/s]
2025-11-19 23:16:13,745 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:16:13,745 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CA...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.42it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 162.99it/s]
2025-11-19 23:16:13,780 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:16:15,947 - core.llm_manager - INFO - Generated response in 2.17s, tokens: 3344
2025-11-19 23:16:15,952 - core.sql_generator - WARNING - [SQL_GEN] Type error detected, attempting automatic fix: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:15,954 - core.sql_generator - WARNING - [SQL_GEN] Validation failed: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:15,954 - core.sql_generator - INFO - [SQL_GEN] Attempt 2/4
2025-11-19 23:16:17,332 - core.llm_manager - INFO - Generated response in 1.38s, tokens: 3344
2025-11-19 23:16:17,334 - core.sql_generator - WARNING - [SQL_GEN] Type error detected, attempting automatic fix: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:17,334 - core.sql_generator - WARNING - [SQL_GEN] Validation failed: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:17,334 - core.sql_generator - INFO - [SQL_GEN] Attempt 3/4
2025-11-19 23:16:18,034 - core.llm_manager - INFO - Generated response in 0.70s, tokens: 3344
2025-11-19 23:16:18,037 - core.sql_generator - WARNING - [SQL_GEN] Type error detected, attempting automatic fix: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:18,037 - core.sql_generator - WARNING - [SQL_GEN] Validation failed: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:18,038 - core.sql_generator - INFO - [SQL_GEN] Attempt 4/4
2025-11-19 23:16:18,742 - core.llm_manager - INFO - Generated response in 0.70s, tokens: 3344
2025-11-19 23:16:18,744 - core.sql_generator - WARNING - [SQL_GEN] Type error detected, attempting automatic fix: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:18,744 - core.sql_generator - WARNING - [SQL_GEN] Validation failed: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:18,744 - core.sql_generator - ERROR - [SQL_GEN] Failed to generate valid SQL after 3 attempts
2025-11-19 23:16:18,744 - agents.enhanced_sql_agent - ERROR - [ENHANCED_SQL_AGENT] Error processing question: SQL generation failed after 3 attempts. Last error: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/dark/Documents/GitHub/SQL_Agent_proj/agents/enhanced_sql_agent.py", line 197, in process_question
    generated_sql = self.sql_generator.generate_sql(question, strategy)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dark/Documents/GitHub/SQL_Agent_proj/core/sql_generator.py", line 192, in generate_sql
    raise Exception(f"SQL generation failed after {self.max_retries} attempts. Last error: {last_error}")
Exception: SQL generation failed after 3 attempts. Last error: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:18,745 - agents.orchestrator - ERROR - [ORCHESTRATOR] SQL generation failed: SQL generation failed after 3 attempts. Last error: (psycopg2.errors.UndefinedTable) relation "credit_bureau_data" does not exist
LINE 1: ...tatus = 'closed' THEN 1 END) AS closed_loans FROM credit_bur...
                                                             ^

[SQL: EXPLAIN SELECT borrower_gender, COUNT(CASE WHEN loan_status = 'active' THEN 1 END) AS active_loans, COUNT(CASE WHEN loan_status = 'closed' THEN 1 END) AS closed_loans FROM credit_bureau_data GROUP BY borrower_gender LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:18,746 - __main__ - INFO - 
[14/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –æ–±—ä—ë–º –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –∫–ª–∏–µ–Ω—Ç—É –¥–ª—è —Ä–∞—Å—Å—Ä–æ—á–µ–∫, –æ—Ç–Ω–æ—Å—è—â–∏...
2025-11-19 23:16:18,746 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –æ–±—ä—ë–º –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –∫–ª–∏–µ–Ω—Ç—É –¥–ª—è —Ä–∞—Å—Å—Ä–æ—á–µ–∫, –æ—Ç–Ω–æ—Å—è—â–∏—Ö—Å—è –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –≥–æ–¥...'
2025-11-19 23:16:18,746 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:16:19,352 - core.llm_manager - INFO - Generated response in 0.61s, tokens: 132
2025-11-19 23:16:19,353 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'How is the accumulated payment volume for a client distributed across installments related to the la...'
2025-11-19 23:16:19,353 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:16:19,353 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:16:20,168 - core.llm_manager - INFO - Generated response in 0.81s, tokens: 316
2025-11-19 23:16:20,172 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:16:20,172 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the total payment volume for each client, broken down by installment, segment, and payment...
2025-11-19 23:16:20,172 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the total payment volume for each client, broken down by installment, segment, and payment...'
2025-11-19 23:16:20,172 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:16:20,173 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the total payment volume for each client, broken down by installment, segment, and payment...'
2025-11-19 23:16:20,173 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.47it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 88.52it/s]
2025-11-19 23:16:20,220 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:16:20,224 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the total payment volume for each client, broken down by installment, segment, and payment...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 165.38it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 160.01it/s]
2025-11-19 23:16:20,253 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:16:21,099 - core.llm_manager - INFO - Generated response in 0.84s, tokens: 1849
2025-11-19 23:16:21,110 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.89s after 0 retries
2025-11-19 23:16:21,110 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:16:21,110 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:16:34,289 - core.database_adapter - INFO - Query executed in 13.17s, returned 100 rows
2025-11-19 23:16:34,289 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 100 rows in 13.17s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.97it/s]
2025-11-19 23:16:34,318 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:16:34,318 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:16:34,318 - core.enhanced_rag_system - INFO - Learned from query execution: 100 rows in 13.17s
2025-11-19 23:16:34,318 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:16:34,318 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 14.15s
2025-11-19 23:16:34,319 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=100, time=13.17s
2025-11-19 23:16:34,319 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:16:34,319 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=100, cols=3, question='Calculate the total payment volume for each client, broken d...'
2025-11-19 23:16:34,319 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:16:34,379 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:16:34,380 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:16:34,380 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpi6tirclz.
2025-11-19 23:16:34,380 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:16:34,381 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmp4kkwxn4a.
2025-11-19 23:16:34,394 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:16:34,395 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmp4kkwxn4a
2025-11-19 23:16:34,965 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpi6tirclz/index.html
2025-11-19 23:16:34,965 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:16:37,348 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:16:37,350 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:16:37,353 - kaleido.kaleido - INFO - Got FEDC
2025-11-19 23:16:37,353 - kaleido._kaleido_tab - INFO - Processing num_instalment_version_by_sk_id_curr.png
2025-11-19 23:16:37,353 - kaleido._kaleido_tab - INFO - Sending big command for num_instalment_version_by_sk_id_curr.png.
2025-11-19 23:16:37,545 - kaleido._kaleido_tab - INFO - Sent big command for num_instalment_version_by_sk_id_curr.png.
2025-11-19 23:16:37,545 - kaleido.kaleido - INFO - Reloading tab FEDC before return.
2025-11-19 23:16:37,768 - kaleido.kaleido - INFO - Putting tab FEDC back (queue size: 0).
2025-11-19 23:16:37,768 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:16:37,768 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:16:37,768 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:16:37,769 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:16:37,770 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:16:37,770 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:16:37,770 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:16:37,771 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:16:37,943 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:16:37,944 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:16:37,944 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:16:37,945 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:16:37,945 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:16:37,945 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:16:37,949 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=24958 bytes
2025-11-19 23:16:37,950 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:16:37,950 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:16:37,950 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate the total payment volume for each client, broken d...', rows=100, cols=3
2025-11-19 23:16:37,964 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:16:41,452 - core.llm_manager - INFO - Generated response in 3.49s, tokens: 1335
2025-11-19 23:16:41,452 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 3305 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:16:41,453 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=6, recommendations=2, confidence=1.00
2025-11-19 23:16:41,453 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=6
2025-11-19 23:16:41,456 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:16:42,848 - core.llm_manager - INFO - Generated response in 1.39s, tokens: 409
2025-11-19 23:16:45,026 - core.llm_manager - INFO - Generated response in 2.18s, tokens: 1257
2025-11-19 23:16:45,738 - core.llm_manager - INFO - Generated response in 0.71s, tokens: 60
2025-11-19 23:16:46,260 - core.llm_manager - INFO - Generated response in 0.52s, tokens: 60
2025-11-19 23:16:46,648 - core.llm_manager - INFO - Generated response in 0.39s, tokens: 63
2025-11-19 23:16:47,002 - core.llm_manager - INFO - Generated response in 0.35s, tokens: 61
2025-11-19 23:16:47,409 - core.llm_manager - INFO - Generated response in 0.41s, tokens: 61
2025-11-19 23:16:48,480 - core.llm_manager - INFO - Generated response in 1.07s, tokens: 63
2025-11-19 23:16:48,982 - core.llm_manager - INFO - Generated response in 0.50s, tokens: 68
2025-11-19 23:16:49,702 - core.llm_manager - INFO - Generated response in 0.72s, tokens: 67
2025-11-19 23:16:50,251 - core.llm_manager - INFO - Generated response in 0.55s, tokens: 176
2025-11-19 23:16:50,252 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:16:50,254 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...NUM_INSTALMENT_VERSION ORDER BY metric_value DESC; LIMIT 100
                                                              ^

[SQL: WITH inst AS ( SELECT SK_ID_CURR, SK_ID_PREV, NUM_INSTALMENT_VERSION, NUM_INSTALMENT_NUMBER, DAYS_INSTALMENT, DAYS_ENTRY_PAYMENT, AMT_INSTALMENT, AMT_PAYMENT, (AMT_PAYMENT - AMT_INSTALMENT) AS payment_diff, (DAYS_ENTRY_PAYMENT - DAYS_INSTALMENT) AS delay_days, SUM(AMT_PAYMENT) OVER (PARTITION BY SK_ID_CURR ORDER BY NUM_INSTALMENT_NUMBER ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cum_payment FROM installments_payments WHERE DAYS_INSTALMENT BETWEEN -365 AND 0 ) SELECT NUM_INSTALMENT_VERSION AS group_key, AVG(cum_payment) AS metric_value FROM inst GROUP BY NUM_INSTALMENT_VERSION ORDER BY metric_value DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:50,254 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...NUM_INSTALMENT_VERSION ORDER BY metric_value DESC; LIMIT 100
                                                              ^

[SQL: WITH inst AS ( SELECT SK_ID_CURR, SK_ID_PREV, NUM_INSTALMENT_VERSION, NUM_INSTALMENT_NUMBER, DAYS_INSTALMENT, DAYS_ENTRY_PAYMENT, AMT_INSTALMENT, AMT_PAYMENT, (AMT_PAYMENT - AMT_INSTALMENT) AS payment_diff, (DAYS_ENTRY_PAYMENT - DAYS_INSTALMENT) AS delay_days, SUM(AMT_PAYMENT) OVER (PARTITION BY SK_ID_CURR ORDER BY NUM_INSTALMENT_NUMBER ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cum_payment FROM installments_payments WHERE DAYS_INSTALMENT BETWEEN -365 AND 0 ) SELECT NUM_INSTALMENT_VERSION AS group_key, AVG(cum_payment) AS metric_value FROM inst GROUP BY NUM_INSTALMENT_VERSION ORDER BY metric_value DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:16:50,254 - __main__ - INFO - 
[15/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –≤–µ–¥—É—â–∏–µ –∫ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º —Ä–µ—à–µ–Ω–∏—è–º –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –æ–±—Ä–∞—â–µ–Ω...
2025-11-19 23:16:50,254 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –≤–µ–¥—É—â–∏–µ –∫ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º —Ä–µ—à–µ–Ω–∏—è–º –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –æ–±—Ä–∞—â–µ–Ω–∏—è–º....'
2025-11-19 23:16:50,254 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:16:50,938 - core.llm_manager - INFO - Generated response in 0.68s, tokens: 73
2025-11-19 23:16:50,939 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Identify the key factors leading to negative decisions on previous applications....'
2025-11-19 23:16:50,939 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:16:50,939 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:16:51,529 - core.llm_manager - INFO - Generated response in 0.59s, tokens: 215
2025-11-19 23:16:51,530 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:16:51,530 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: SELECT factors FROM application_decisions WHERE decision = 'negative'...
2025-11-19 23:16:51,533 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'SELECT factors FROM application_decisions WHERE decision = 'negative'...'
2025-11-19 23:16:51,533 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:16:51,533 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'SELECT factors FROM application_decisions WHERE decision = 'negative'...'
2025-11-19 23:16:51,533 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 33.63it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 180.93it/s]
2025-11-19 23:16:51,589 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:16:51,590 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'SELECT factors FROM application_decisions WHERE decision = 'negative'...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.70it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.00it/s]
2025-11-19 23:16:51,621 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:16:52,036 - core.llm_manager - INFO - Generated response in 0.42s, tokens: 3101
2025-11-19 23:16:52,038 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.45s after 0 retries
2025-11-19 23:16:52,039 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:16:52,039 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:16:53,264 - core.database_adapter - INFO - Query executed in 1.22s, returned 0 rows
2025-11-19 23:16:53,264 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 0 rows in 1.22s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 57.33it/s]
2025-11-19 23:16:53,305 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:16:53,305 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:16:53,305 - core.enhanced_rag_system - INFO - Learned from query execution: 0 rows in 1.22s
2025-11-19 23:16:53,305 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:16:53,305 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 1.77s
2025-11-19 23:16:53,306 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=0, time=1.22s
2025-11-19 23:16:53,306 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization skipped (not needed or no data)
2025-11-19 23:16:53,306 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:16:54,171 - core.llm_manager - INFO - Generated response in 0.87s, tokens: 228
2025-11-19 23:16:54,535 - core.llm_manager - INFO - Generated response in 0.36s, tokens: 126
2025-11-19 23:16:55,149 - core.llm_manager - INFO - Generated response in 0.61s, tokens: 43
2025-11-19 23:16:55,651 - core.llm_manager - INFO - Generated response in 0.50s, tokens: 42
2025-11-19 23:16:56,013 - core.llm_manager - INFO - Generated response in 0.36s, tokens: 79
2025-11-19 23:16:56,013 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=query
2025-11-19 23:16:56,014 - __main__ - INFO - 
[16/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–∞–∫–æ–≤–∞ –¥–æ–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π, –ø–æ—Å—Ç—É–ø–∏–≤—à–∏—Ö –≤ —Ç–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è (—Å 9 —É—Ç—Ä–∞ –¥...
2025-11-19 23:16:56,014 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–∞–∫–æ–≤–∞ –¥–æ–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π, –ø–æ—Å—Ç—É–ø–∏–≤—à–∏—Ö –≤ —Ç–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è (—Å 9 —É—Ç—Ä–∞ –¥–æ 6 –≤–µ—á–µ—Ä–∞), –æ—Ç –æ–±—â–µ...'
2025-11-19 23:16:56,014 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:16:56,713 - core.llm_manager - INFO - Generated response in 0.70s, tokens: 102
2025-11-19 23:16:56,715 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'What is the percentage of customer inquiries received during business hours (9 AM to 6 PM) out of th...'
2025-11-19 23:16:56,717 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:16:56,717 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:16:57,472 - core.llm_manager - INFO - Generated response in 0.75s, tokens: 277
2025-11-19 23:16:57,473 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:16:57,475 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate (COUNT(CASE WHEN inquiry_time BETWEEN '09:00:00' AND '18:00:00' THEN 1 ELSE NULL END) * 10...
2025-11-19 23:16:57,476 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate (COUNT(CASE WHEN inquiry_time BETWEEN '09:00:00' AND '18:00:00' THEN 1 ELSE NULL END) * 10...'
2025-11-19 23:16:57,476 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:16:57,476 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate (COUNT(CASE WHEN inquiry_time BETWEEN '09:00:00' AND '18:00:00' THEN 1 ELSE NULL END) * 10...'
2025-11-19 23:16:57,476 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 109.29it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 90.39it/s]
2025-11-19 23:16:57,527 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:16:57,527 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate (COUNT(CASE WHEN inquiry_time BETWEEN '09:00:00' AND '18:00:00' THEN 1 ELSE NULL END) * 10...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 109.33it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 96.64it/s]
2025-11-19 23:16:57,579 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:16:58,105 - core.llm_manager - INFO - Generated response in 0.53s, tokens: 3082
2025-11-19 23:16:58,112 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.59s after 0 retries
2025-11-19 23:16:58,112 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:16:58,112 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:16:59,169 - core.database_adapter - INFO - Query executed in 1.05s, returned 1 rows
2025-11-19 23:16:59,169 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 1 rows in 1.05s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 98.24it/s]
2025-11-19 23:16:59,202 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:16:59,202 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:16:59,202 - core.enhanced_rag_system - INFO - Learned from query execution: 1 rows in 1.05s
2025-11-19 23:16:59,202 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:16:59,202 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 1.73s
2025-11-19 23:16:59,203 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=1, time=1.05s
2025-11-19 23:16:59,203 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization skipped (not needed or no data)
2025-11-19 23:16:59,203 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:16:59,203 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate (COUNT(CASE WHEN inquiry_time BETWEEN '09:00:00' A...', rows=1, cols=1
2025-11-19 23:16:59,207 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:16:59,955 - core.llm_manager - INFO - Generated response in 0.75s, tokens: 433
2025-11-19 23:16:59,955 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 452 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:16:59,955 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=1, recommendations=2, confidence=0.70
2025-11-19 23:16:59,955 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=1
2025-11-19 23:16:59,956 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:17:01,127 - core.llm_manager - INFO - Generated response in 1.17s, tokens: 311
2025-11-19 23:17:02,081 - core.llm_manager - INFO - Generated response in 0.95s, tokens: 250
2025-11-19 23:17:03,300 - core.llm_manager - INFO - Generated response in 1.22s, tokens: 59
2025-11-19 23:17:03,657 - core.llm_manager - INFO - Generated response in 0.36s, tokens: 62
2025-11-19 23:17:03,957 - core.llm_manager - INFO - Generated response in 0.30s, tokens: 58
2025-11-19 23:17:03,958 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=query
2025-11-19 23:17:03,963 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...) * 100.0) / COUNT(*) FROM application_train_test; LIMIT 100
                                                              ^

[SQL: SELECT (SUM(CASE WHEN HOUR_APPR_PROCESS_START BETWEEN 9 AND 18 THEN 1 ELSE 0 END) * 100.0) / COUNT(*) FROM application_train_test; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:03,963 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...) * 100.0) / COUNT(*) FROM application_train_test; LIMIT 100
                                                              ^

[SQL: SELECT (SUM(CASE WHEN HOUR_APPR_PROCESS_START BETWEEN 9 AND 18 THEN 1 ELSE 0 END) * 100.0) / COUNT(*) FROM application_train_test; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:03,963 - __main__ - INFO - 
[17/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ö–∞–∫–æ–≤–∞ –æ–±—â–∞—è —Å—É–º–º–∞ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º, –Ω—ã–Ω–µ –∫...
2025-11-19 23:17:03,963 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ö–∞–∫–æ–≤–∞ –æ–±—â–∞—è —Å—É–º–º–∞ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º, –Ω—ã–Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–∞...'
2025-11-19 23:17:03,963 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:17:05,456 - core.llm_manager - INFO - Generated response in 1.49s, tokens: 87
2025-11-19 23:17:05,457 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'What is the total amount of debt recorded for loans now classified as 'closed' in the credit bureau?...'
2025-11-19 23:17:05,457 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:17:05,457 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:17:06,462 - core.llm_manager - INFO - Generated response in 1.00s, tokens: 210
2025-11-19 23:17:06,466 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:17:06,466 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the sum of debt for all loans where the status is 'closed' in the credit bureau data....
2025-11-19 23:17:06,466 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the sum of debt for all loans where the status is 'closed' in the credit bureau data....'
2025-11-19 23:17:06,466 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:17:06,467 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the sum of debt for all loans where the status is 'closed' in the credit bureau data....'
2025-11-19 23:17:06,467 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 181.14it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 174.06it/s]
2025-11-19 23:17:06,501 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:17:06,501 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the sum of debt for all loans where the status is 'closed' in the credit bureau data....' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 168.28it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 166.04it/s]
2025-11-19 23:17:06,539 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:17:07,053 - core.llm_manager - INFO - Generated response in 0.51s, tokens: 3271
2025-11-19 23:17:07,059 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.56s after 0 retries
2025-11-19 23:17:07,060 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:17:07,060 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:17:07,811 - core.database_adapter - INFO - Query executed in 0.75s, returned 1 rows
2025-11-19 23:17:07,811 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 1 rows in 0.75s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 76.87it/s]
2025-11-19 23:17:07,843 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:17:07,843 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:17:07,843 - core.enhanced_rag_system - INFO - Learned from query execution: 1 rows in 0.75s
2025-11-19 23:17:07,844 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:17:07,844 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 1.38s
2025-11-19 23:17:07,844 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=1, time=0.75s
2025-11-19 23:17:07,844 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization skipped (not needed or no data)
2025-11-19 23:17:07,844 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:17:07,844 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate the sum of debt for all loans where the status is ...', rows=1, cols=1
2025-11-19 23:17:07,847 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:17:08,481 - core.llm_manager - INFO - Generated response in 0.63s, tokens: 299
2025-11-19 23:17:08,481 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 236 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:17:08,481 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=1, recommendations=2, confidence=0.70
2025-11-19 23:17:08,481 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=1
2025-11-19 23:17:08,481 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:17:09,207 - core.llm_manager - INFO - Generated response in 0.73s, tokens: 230
2025-11-19 23:17:09,808 - core.llm_manager - INFO - Generated response in 0.60s, tokens: 160
2025-11-19 23:17:10,183 - core.llm_manager - INFO - Generated response in 0.38s, tokens: 59
2025-11-19 23:17:10,980 - core.llm_manager - INFO - Generated response in 0.80s, tokens: 62
2025-11-19 23:17:11,527 - core.llm_manager - INFO - Generated response in 0.55s, tokens: 58
2025-11-19 23:17:11,527 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=query
2025-11-19 23:17:11,530 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ..._DEBT) FROM bureau WHERE CREDIT_ACTIVE = 'Closed'; LIMIT 100
                                                              ^

[SQL: SELECT SUM(AMT_CREDIT_SUM_DEBT) FROM bureau WHERE CREDIT_ACTIVE = 'Closed'; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:11,530 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ..._DEBT) FROM bureau WHERE CREDIT_ACTIVE = 'Closed'; LIMIT 100
                                                              ^

[SQL: SELECT SUM(AMT_CREDIT_SUM_DEBT) FROM bureau WHERE CREDIT_ACTIVE = 'Closed'; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:11,530 - __main__ - INFO - 
[18/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –°–∫–æ–ª—å–∫–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–æ—Å–∏–ª–∏ —Ç–µ, –∫–æ–º—É –º—ã –æ—Ç–∫–∞–∑–∞–ª–∏ –≤ –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑?...
2025-11-19 23:17:11,530 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–°–∫–æ–ª—å–∫–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–æ—Å–∏–ª–∏ —Ç–µ, –∫–æ–º—É –º—ã –æ—Ç–∫–∞–∑–∞–ª–∏ –≤ –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑?...'
2025-11-19 23:17:11,530 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:17:12,087 - core.llm_manager - INFO - Generated response in 0.55s, tokens: 65
2025-11-19 23:17:12,089 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'What was the average amount requested by those we rejected last time?...'
2025-11-19 23:17:12,090 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:17:12,090 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:17:12,795 - core.llm_manager - INFO - Generated response in 0.70s, tokens: 209
2025-11-19 23:17:12,796 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:17:12,796 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Calculate the average of `amount_requested` for records where `status` was 'rejected' in the previou...
2025-11-19 23:17:12,796 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Calculate the average of `amount_requested` for records where `status` was 'rejected' in the previou...'
2025-11-19 23:17:12,796 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:17:12,796 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Calculate the average of `amount_requested` for records where `status` was 'rejected' in the previou...'
2025-11-19 23:17:12,796 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 170.34it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 99.17it/s]
2025-11-19 23:17:12,840 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:17:12,841 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Calculate the average of `amount_requested` for records where `status` was 'rejected' in the previou...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 110.64it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.11it/s]
2025-11-19 23:17:12,887 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:17:13,769 - core.llm_manager - INFO - Generated response in 0.88s, tokens: 3186
2025-11-19 23:17:13,772 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 0.93s after 0 retries
2025-11-19 23:17:13,775 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.70, retries=0
2025-11-19 23:17:13,776 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:17:14,910 - core.database_adapter - INFO - Query executed in 1.13s, returned 1 rows
2025-11-19 23:17:14,910 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 1 rows in 1.13s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 90.34it/s]
2025-11-19 23:17:14,951 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:17:14,952 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:17:14,952 - core.enhanced_rag_system - INFO - Learned from query execution: 1 rows in 1.13s
2025-11-19 23:17:14,952 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:17:14,952 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 2.16s
2025-11-19 23:17:14,953 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=1, time=1.13s
2025-11-19 23:17:14,953 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization skipped (not needed or no data)
2025-11-19 23:17:14,953 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:17:14,953 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Calculate the average of `amount_requested` for records wher...', rows=1, cols=1
2025-11-19 23:17:14,955 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:17:16,923 - core.llm_manager - INFO - Generated response in 1.97s, tokens: 361
2025-11-19 23:17:16,924 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 421 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:17:16,924 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=1, recommendations=2, confidence=0.70
2025-11-19 23:17:16,926 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=1
2025-11-19 23:17:16,926 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:17:17,697 - core.llm_manager - INFO - Generated response in 0.77s, tokens: 312
2025-11-19 23:17:18,599 - core.llm_manager - INFO - Generated response in 0.90s, tokens: 245
2025-11-19 23:17:19,102 - core.llm_manager - INFO - Generated response in 0.50s, tokens: 59
2025-11-19 23:17:19,451 - core.llm_manager - INFO - Generated response in 0.35s, tokens: 62
2025-11-19 23:17:20,009 - core.llm_manager - INFO - Generated response in 0.56s, tokens: 58
2025-11-19 23:17:20,009 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=query
2025-11-19 23:17:20,012 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...pplication WHERE NAME_CONTRACT_STATUS = 'Refused'; LIMIT 100
                                                              ^

[SQL: SELECT AVG(AMT_APPLICATION) FROM previous_application WHERE NAME_CONTRACT_STATUS = 'Refused'; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:20,012 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...pplication WHERE NAME_CONTRACT_STATUS = 'Refused'; LIMIT 100
                                                              ^

[SQL: SELECT AVG(AMT_APPLICATION) FROM previous_application WHERE NAME_CONTRACT_STATUS = 'Refused'; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:20,012 - __main__ - INFO - 
[19/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ bureau, –≥–¥–µ –¥–ª—è –∫—Ä–µ–¥–∏—Ç–æ–≤ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –∞–Ω–Ω—É–∏—Ç–µ...
2025-11-19 23:17:20,012 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ü–æ—Å—Ç—Ä–æ–π—Ç–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ bureau, –≥–¥–µ –¥–ª—è –∫—Ä–µ–¥–∏—Ç–æ–≤ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –∞–Ω–Ω—É–∏—Ç–µ—Ç–æ–º (AMT_ANNUITY IS ...'
2025-11-19 23:17:20,012 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:17:21,175 - core.llm_manager - INFO - Generated response in 1.16s, tokens: 152
2025-11-19 23:17:21,176 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Build an aggregated report by bureau, where for loans with a filled annuity (AMT_ANNUITY IS NOT NULL...'
2025-11-19 23:17:21,176 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:17:21,176 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:17:22,134 - core.llm_manager - INFO - Generated response in 0.96s, tokens: 272
2025-11-19 23:17:22,135 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:17:22,135 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: ```sql...
2025-11-19 23:17:22,135 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: '```sql...'
2025-11-19 23:17:22,135 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:17:22,135 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: '```sql...'
2025-11-19 23:17:22,136 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 95.72it/s]
2025-11-19 23:17:22,165 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:22,165 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:22,166 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:22,166 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 79.42it/s]
2025-11-19 23:17:22,202 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:17:22,202 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: '```sql...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.13it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 123.24it/s]
2025-11-19 23:17:22,259 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:17:23,250 - core.llm_manager - INFO - Generated response in 0.99s, tokens: 15701
2025-11-19 23:17:23,257 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 1.05s after 0 retries
2025-11-19 23:17:23,258 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:17:23,258 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:17:23,264 - core.database_adapter - INFO - Query executed in 0.00s, returned 100 rows
2025-11-19 23:17:23,264 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 100 rows in 0.00s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 87.79it/s]
2025-11-19 23:17:23,293 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:17:23,293 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: None
2025-11-19 23:17:23,293 - core.enhanced_rag_system - INFO - Learned from query execution: 100 rows in 0.00s
2025-11-19 23:17:23,294 - core.dynamic_semantic_layer - INFO - Learned from query: 1 tables, feedback: successful
2025-11-19 23:17:23,294 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 1.16s
2025-11-19 23:17:23,294 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=100, time=0.00s
2025-11-19 23:17:23,294 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:17:23,294 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=100, cols=1, question='```sql...'
2025-11-19 23:17:23,294 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:17:23,354 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:17:23,355 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:17:23,355 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmphnbzlo3j.
2025-11-19 23:17:23,355 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:17:23,356 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpsexo1flm.
2025-11-19 23:17:23,366 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:17:23,366 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpsexo1flm
2025-11-19 23:17:23,933 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmphnbzlo3j/index.html
2025-11-19 23:17:23,933 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:17:26,182 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:17:26,182 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:17:26,182 - kaleido.kaleido - INFO - Got 7B2E
2025-11-19 23:17:26,183 - kaleido._kaleido_tab - INFO - Processing amt_credit_by_index.png
2025-11-19 23:17:26,183 - kaleido._kaleido_tab - INFO - Sending big command for amt_credit_by_index.png.
2025-11-19 23:17:26,382 - kaleido._kaleido_tab - INFO - Sent big command for amt_credit_by_index.png.
2025-11-19 23:17:26,383 - kaleido.kaleido - INFO - Reloading tab 7B2E before return.
2025-11-19 23:17:26,583 - kaleido.kaleido - INFO - Putting tab 7B2E back (queue size: 0).
2025-11-19 23:17:26,583 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:17:26,583 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:17:26,583 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:17:26,585 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:17:26,586 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:26,586 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:26,586 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:17:26,586 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:17:26,819 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:26,821 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:26,821 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:26,822 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:26,822 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:17:26,822 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:17:26,828 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=39996 bytes
2025-11-19 23:17:26,829 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:17:26,829 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:17:26,829 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='```sql...', rows=100, cols=1
2025-11-19 23:17:26,833 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:17:29,063 - core.llm_manager - INFO - Generated response in 2.23s, tokens: 451
2025-11-19 23:17:29,063 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 961 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:17:29,064 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=2, recommendations=2, confidence=1.00
2025-11-19 23:17:29,064 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=2
2025-11-19 23:17:29,064 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:17:30,069 - core.llm_manager - INFO - Generated response in 1.00s, tokens: 363
2025-11-19 23:17:31,094 - core.llm_manager - INFO - Generated response in 1.03s, tokens: 510
2025-11-19 23:17:31,991 - core.llm_manager - INFO - Generated response in 0.89s, tokens: 60
2025-11-19 23:17:32,408 - core.llm_manager - INFO - Generated response in 0.42s, tokens: 55
2025-11-19 23:17:32,715 - core.llm_manager - INFO - Generated response in 0.31s, tokens: 68
2025-11-19 23:17:33,388 - core.llm_manager - INFO - Generated response in 0.67s, tokens: 67
2025-11-19 23:17:33,691 - core.llm_manager - INFO - Generated response in 0.30s, tokens: 51
2025-11-19 23:17:33,691 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:17:33,693 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...ULL GROUP BY CREDIT_TYPE ORDER BY avg_metric DESC; LIMIT 100
                                                              ^

[SQL: SELECT CREDIT_TYPE AS group_key, AVG(AMT_CREDIT_SUM_DEBT) AS avg_metric FROM bureau WHERE AMT_ANNUITY IS NOT NULL GROUP BY CREDIT_TYPE ORDER BY avg_metric DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:33,693 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.SyntaxError) syntax error at or near "LIMIT"
LINE 1: ...ULL GROUP BY CREDIT_TYPE ORDER BY avg_metric DESC; LIMIT 100
                                                              ^

[SQL: SELECT CREDIT_TYPE AS group_key, AVG(AMT_CREDIT_SUM_DEBT) AS avg_metric FROM bureau WHERE AMT_ANNUITY IS NOT NULL GROUP BY CREDIT_TYPE ORDER BY avg_metric DESC; LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:33,695 - __main__ - INFO - 
[20/20] –í–∞–ª–∏–¥–∞—Ü–∏—è: –ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–µ—Ç–µ–π —É —á–µ–ª–æ–≤–µ–∫–∞ –∏ —Ç–µ–º, –∫–∞–∫ –æ–Ω –ø–ª–∞—Ç–∏—Ç –ø–æ –∫...
2025-11-19 23:17:33,695 - agents.orchestrator - INFO - [ORCHESTRATOR] Received request: '–ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–µ—Ç–µ–π —É —á–µ–ª–æ–≤–µ–∫–∞ –∏ —Ç–µ–º, –∫–∞–∫ –æ–Ω –ø–ª–∞—Ç–∏—Ç –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º?...'
2025-11-19 23:17:33,696 - agents.orchestrator - INFO - [ORCHESTRATOR] Context: none
2025-11-19 23:17:34,408 - core.llm_manager - INFO - Generated response in 0.71s, tokens: 77
2025-11-19 23:17:34,408 - agents.orchestrator - INFO - [ORCHESTRATOR] Russian detected, translated: 'Is there a correlation between the number of children a person has and how they repay loans?...'
2025-11-19 23:17:34,409 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 1: ANALYSIS =====
2025-11-19 23:17:34,409 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analyzing query intent...
2025-11-19 23:17:35,266 - core.llm_manager - INFO - Generated response in 0.86s, tokens: 241
2025-11-19 23:17:35,269 - agents.orchestrator - INFO - [ORCHESTRATOR] [ANALYSIS] Analysis complete
2025-11-19 23:17:35,270 - agents.orchestrator - INFO - [ORCHESTRATOR] Using refined query from analysis: Analyze the relationship between the count of children associated with a borrower and their loan rep...
2025-11-19 23:17:35,270 - agents.orchestrator - INFO - [ORCHESTRATOR] Refined prompt: 'Analyze the relationship between the count of children associated with a borrower and their loan rep...'
2025-11-19 23:17:35,270 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 2: SQL GENERATION WITH RAG =====
2025-11-19 23:17:35,271 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Processing: 'Analyze the relationship between the count of children associated with a borrower and their loan rep...'
2025-11-19 23:17:35,271 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 2: Selecting relevant data...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 74.23it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 62.71it/s]
2025-11-19 23:17:35,364 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 3: Generating SQL with LLM...
2025-11-19 23:17:35,364 - core.sql_generator - INFO - [SQL_GEN] Generating SQL for: 'Analyze the relationship between the count of children associated with a borrower and their loan rep...' with strategy: full_context
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 106.45it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 106.13it/s]
2025-11-19 23:17:35,430 - core.sql_generator - INFO - [SQL_GEN] Attempt 1/4
2025-11-19 23:17:36,752 - core.llm_manager - INFO - Generated response in 1.32s, tokens: 15595
2025-11-19 23:17:36,766 - core.sql_generator - INFO - [SQL_GEN] Successfully generated SQL in 1.40s after 0 retries
2025-11-19 23:17:36,766 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] SQL generated: confidence=0.55, retries=0
2025-11-19 23:17:36,766 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Stage 4: Executing SQL query...
2025-11-19 23:17:38,350 - core.database_adapter - INFO - Query executed in 1.58s, returned 22 rows
2025-11-19 23:17:38,350 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Query executed: 22 rows in 1.58s
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 102.99it/s]
2025-11-19 23:17:38,379 - core.enhanced_rag_system - INFO - Added 1 documents to RAG system
2025-11-19 23:17:38,379 - core.dynamic_semantic_layer - INFO - Learned from query: 2 tables, feedback: None
2025-11-19 23:17:38,380 - core.enhanced_rag_system - INFO - Learned from query execution: 22 rows in 1.58s
2025-11-19 23:17:38,380 - core.dynamic_semantic_layer - INFO - Learned from query: 2 tables, feedback: successful
2025-11-19 23:17:38,380 - agents.enhanced_sql_agent - INFO - [ENHANCED_SQL_AGENT] Total processing time: 3.11s
2025-11-19 23:17:38,380 - agents.orchestrator - INFO - [ORCHESTRATOR] SQL executed: rows=22, time=1.58s
2025-11-19 23:17:38,381 - agents.orchestrator - INFO - [ORCHESTRATOR] ===== STEP 3: VISUALIZATION =====
2025-11-19 23:17:38,381 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: rows=22, cols=3, question='Analyze the relationship between the count of children assoc...'
2025-11-19 23:17:38,381 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞: True
2025-11-19 23:17:38,435 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:38,436 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:38,446 - choreographer.browsers.chromium - INFO - Chromium init'ed with kwargs {}
2025-11-19 23:17:38,447 - choreographer.browsers.chromium - INFO - Found chromium path: /usr/local/bin/chrome
2025-11-19 23:17:38,447 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpv2ng6sdy.
2025-11-19 23:17:38,447 - choreographer.browser_async - INFO - Opening browser.
2025-11-19 23:17:38,448 - choreographer.utils._tmpfile - INFO - Temp directory created: /tmp/tmpsbz1sptz.
2025-11-19 23:17:38,460 - choreographer.browsers.chromium - INFO - ldd failed. e: Command '['ldd', '/usr/local/bin/chrome']' returned non-zero exit status 1., stderr: None
2025-11-19 23:17:38,461 - choreographer.browsers.chromium - INFO - Temporary directory at: /tmp/tmpsbz1sptz
2025-11-19 23:17:39,178 - kaleido.kaleido - INFO - Conforming 1 to file:///tmp/tmpv2ng6sdy/index.html
2025-11-19 23:17:39,179 - kaleido.kaleido - INFO - Waiting on all navigates
2025-11-19 23:17:41,544 - kaleido.kaleido - INFO - All navigates done, putting them all in queue.
2025-11-19 23:17:41,545 - kaleido.kaleido - INFO - Getting tab from queue (has 1)
2025-11-19 23:17:41,545 - kaleido.kaleido - INFO - Got 8C54
2025-11-19 23:17:41,545 - kaleido._kaleido_tab - INFO - Processing repayment_status_by_cnt_children.png
2025-11-19 23:17:41,545 - kaleido._kaleido_tab - INFO - Sending big command for repayment_status_by_cnt_children.png.
2025-11-19 23:17:41,795 - kaleido._kaleido_tab - INFO - Sent big command for repayment_status_by_cnt_children.png.
2025-11-19 23:17:41,795 - kaleido.kaleido - INFO - Reloading tab 8C54 before return.
2025-11-19 23:17:42,067 - kaleido.kaleido - INFO - Putting tab 8C54 back (queue size: 0).
2025-11-19 23:17:42,067 - kaleido.kaleido - INFO - Waiting for all cleanups to finish.
2025-11-19 23:17:42,067 - kaleido.kaleido - INFO - Exiting Kaleido
2025-11-19 23:17:42,067 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:17:42,072 - choreographer.browser_async - INFO - Closing browser.
2025-11-19 23:17:42,072 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:42,072 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:42,072 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:17:42,072 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:17:42,305 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:42,305 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:42,305 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:42,306 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
2025-11-19 23:17:42,306 - kaleido.kaleido - INFO - Cancelling tasks.
2025-11-19 23:17:42,306 - kaleido.kaleido - INFO - Exiting Kaleido/Choreo
2025-11-19 23:17:42,310 - agents.visualization_agent - INFO - [VISUALIZATION_AGENT] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: success=True, type=bar, image_size=28321 bytes
2025-11-19 23:17:42,310 - agents.orchestrator - INFO - [ORCHESTRATOR] Visualization created: success=True, type=bar
2025-11-19 23:17:42,311 - agents.orchestrator - INFO - [ORCHESTRATOR] Analyzing SQL results with AnalysisAgent...
2025-11-19 23:17:42,311 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞: question='Analyze the relationship between the count of children assoc...', rows=22, cols=3
2025-11-19 23:17:42,328 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
2025-11-19 23:17:45,711 - core.llm_manager - INFO - Generated response in 3.38s, tokens: 1279
2025-11-19 23:17:45,711 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: 3265 —Å–∏–º–≤–æ–ª–æ–≤
2025-11-19 23:17:45,711 - agents.analysis_agent - INFO - [ANALYSIS_AGENT] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: insights=5, recommendations=3, confidence=1.00
2025-11-19 23:17:45,712 - agents.orchestrator - INFO - [ORCHESTRATOR] Result analysis complete: insights=5
2025-11-19 23:17:45,712 - agents.orchestrator - INFO - [ORCHESTRATOR] Localizing result to Russian...
2025-11-19 23:17:46,954 - core.llm_manager - INFO - Generated response in 1.24s, tokens: 373
2025-11-19 23:17:49,100 - core.llm_manager - INFO - Generated response in 2.15s, tokens: 1209
2025-11-19 23:17:49,724 - core.llm_manager - INFO - Generated response in 0.62s, tokens: 54
2025-11-19 23:17:50,329 - core.llm_manager - INFO - Generated response in 0.60s, tokens: 57
2025-11-19 23:17:50,934 - core.llm_manager - INFO - Generated response in 0.60s, tokens: 57
2025-11-19 23:17:52,525 - core.llm_manager - INFO - Generated response in 1.59s, tokens: 57
2025-11-19 23:17:52,918 - core.llm_manager - INFO - Generated response in 0.39s, tokens: 57
2025-11-19 23:17:53,227 - core.llm_manager - INFO - Generated response in 0.31s, tokens: 67
2025-11-19 23:17:53,989 - core.llm_manager - INFO - Generated response in 0.76s, tokens: 62
2025-11-19 23:17:54,709 - core.llm_manager - INFO - Generated response in 0.72s, tokens: 58
2025-11-19 23:17:55,585 - core.llm_manager - INFO - Generated response in 0.88s, tokens: 143
2025-11-19 23:17:55,586 - agents.orchestrator - INFO - [ORCHESTRATOR] Pipeline completed: success=True, task_type=visualization
2025-11-19 23:17:55,587 - core.database_adapter - ERROR - Query execution failed: (psycopg2.errors.UndefinedTable) relation "application_train_test" does not exist
LINE 1: SELECT CNT_CHILDREN, AVG(TARGET) * 100 FROM application_trai...
                                                    ^

[SQL: SELECT CNT_CHILDREN, AVG(TARGET) * 100 FROM application_train_test GROUP BY CNT_CHILDREN ORDER BY CNT_CHILDREN LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:55,587 - __main__ - WARNING - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: (psycopg2.errors.UndefinedTable) relation "application_train_test" does not exist
LINE 1: SELECT CNT_CHILDREN, AVG(TARGET) * 100 FROM application_trai...
                                                    ^

[SQL: SELECT CNT_CHILDREN, AVG(TARGET) * 100 FROM application_train_test GROUP BY CNT_CHILDREN ORDER BY CNT_CHILDREN LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-19 23:17:55,587 - __main__ - INFO - üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 20/20 | –°—Ä–∞–±–æ—Ç–∞–ª–æ: 18 (90.0%) | –í—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å: 18 (90.0%) | –ü–æ—Ö–æ–∂–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 (0.0%) | –û—Å—Ç–∞–ª–æ—Å—å: ~0.0 –º–∏–Ω
2025-11-19 23:17:55,594 - __main__ - INFO - 
================================================================================
2025-11-19 23:17:55,594 - __main__ - INFO - üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê
2025-11-19 23:17:55,594 - __main__ - INFO - ================================================================================
2025-11-19 23:17:55,594 - __main__ - INFO - –í—Å–µ–≥–æ –ø—Ä–∏–º–µ—Ä–æ–≤: 20
2025-11-19 23:17:55,594 - __main__ - INFO - –°—Ä–∞–±–æ—Ç–∞–ª–æ (–ø–∞–π–ø–ª–∞–π–Ω —É—Å–ø–µ—à–µ–Ω): 18 (90.0%)
2025-11-19 23:17:55,594 - __main__ - INFO - –í—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å (SQL –≤—ã–ø–æ–ª–Ω–µ–Ω): 18 (90.0%)
2025-11-19 23:17:55,594 - __main__ - INFO - –ü–æ—Ö–æ–∂–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 (0.0%)
2025-11-19 23:17:55,594 - __main__ - INFO - –û—à–∏–±–∫–∏: 2
2025-11-19 23:17:55,594 - __main__ - INFO - –û–±—â–µ–µ –≤—Ä–µ–º—è: 6.6 –º–∏–Ω
2025-11-19 23:17:55,594 - __main__ - INFO - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –ø—Ä–∏–º–µ—Ä: 19.78 —Å–µ–∫
2025-11-19 23:17:55,594 - __main__ - INFO - 
üíæ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: /home/dark/Documents/GitHub/SQL_Agent_proj/tests/results/benchmark_validation_20251119_231755.json
2025-11-19 23:17:55,850 - choreographer.utils._tmpfile - INFO - TemporaryDirectory.cleanup() worked.
2025-11-19 23:17:55,850 - choreographer.utils._tmpfile - INFO - shutil.rmtree worked.
