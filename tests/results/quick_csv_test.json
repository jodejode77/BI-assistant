{
  "dataset_type": "CSV",
  "total_tests": 10,
  "successful": 8,
  "failed": 2,
  "success_rate": 0.8,
  "exact_matches": 0,
  "exact_match_rate": 0.0,
  "avg_similarity": 0.8092440804498758,
  "tables_match_rate": 1.0,
  "semantic_correct_rate": 0.0,
  "avg_generation_time": 1.2421968579292297,
  "avg_retries": 0.0,
  "avg_confidence": 0.49375,
  "total_time": 24.45324420928955,
  "throughput": 0.40894369329535,
  "results": [
    {
      "test_id": 1,
      "question": "По таблице previous_application рассчитайте средний размер одобренного кредита по предыдущим обращениям для предыдущих заявок с суммой кредита более 50 000 в разрезе по типу продукта (NAME_CONTRACT_TYPE) в previous_application.",
      "success": true,
      "generation_time": 1.168818473815918,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit_amount FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.8304093567251462,
        "tables_match": true,
        "where_similarity": 1.0,
        "agg_match": true,
        "group_match": true,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit_amount FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select name_contract_type, avg(amt_credit) as avg_approved_credit_amount from previous_application where amt_credit > 50000 group by name_contract_type limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_credit > 50000 group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 3,
        "expected_rows": 3
      },
      "retry_count": 0,
      "confidence": 0.4
    },
    {
      "test_id": 2,
      "question": "Сформируйте витрину по previous_application, где для предыдущих заявок с суммой кредита более 50 000 и по каждому значению поля NAME_CONTRACT_TYPE показывается средний размер одобренного кредита по предыдущим обращениям.",
      "success": true,
      "generation_time": 1.0079247951507568,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.8477611940298507,
        "tables_match": true,
        "where_similarity": 1.0,
        "agg_match": true,
        "group_match": true,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select name_contract_type, avg(amt_credit) as avg_approved_credit from previous_application where amt_credit > 50000 group by name_contract_type limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_credit > 50000 group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 3,
        "expected_rows": 3
      },
      "retry_count": 0,
      "confidence": 0.55
    },
    {
      "test_id": 3,
      "question": "Как в среднем изменяется размер одобренного кредита по предыдущим заявкам для прошлых кредитов на сумму выше 50 000 между клиентами между различными типами кредитных продуктов в прошлых заявках?",
      "success": false,
      "error": "SQL generation failed after 2 attempts. Last error: (psycopg2.errors.UndefinedColumn) column pb.sk_id_prev does not exist\nLINE 1: ...S pa JOIN bureau_balance AS pb ON pa.SK_ID_PREV = pb.SK_ID_P...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"pa.sk_id_prev\".\n\n[SQL: EXPLAIN SELECT pb.NAME_CONTRACT_STATUS, AVG(pa.AMT_CREDIT) AS average_approved_credit_amount FROM previous_application AS pa JOIN bureau_balance AS pb ON pa.SK_ID_PREV = pb.SK_ID_PREV WHERE pa.AMT_CREDIT > 50000 GROUP BY pb.NAME_CONTRACT_STATUS LIMIT 100]\n(Background on this error at: https://sqlalche.me/e/20/f405)",
      "generation_time": 9.570336818695068,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": null,
      "comparison": null
    },
    {
      "test_id": 4,
      "question": "Сравните размер одобренного кредита по предыдущим заявкам для прошлых кредитов на сумму выше 50 000 для разных категорий по признаку «тип кредитного продукта» в прошлых заявках клиентов.",
      "success": true,
      "generation_time": 2.5434107780456543,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT pa.NAME_CONTRACT_TYPE, pa.AMT_CREDIT, pa.AMT_ANNUITY FROM previous_application AS pa WHERE pa.AMT_CREDIT > 50000 LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.6580645161290323,
        "tables_match": true,
        "where_similarity": 0.9230769230769231,
        "agg_match": false,
        "group_match": false,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT pa.NAME_CONTRACT_TYPE, pa.AMT_CREDIT, pa.AMT_ANNUITY FROM previous_application AS pa WHERE pa.AMT_CREDIT > 50000 LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT > 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select pa.name_contract_type, pa.amt_credit, pa.amt_annuity from previous_application as pa where pa.amt_credit > 50000 limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_credit > 50000 group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 100,
        "expected_rows": 3
      },
      "retry_count": 0,
      "confidence": 0.4
    },
    {
      "test_id": 5,
      "question": "По таблице previous_application рассчитайте средний размер одобренного кредита по предыдущим обращениям для предыдущих заявок с суммой кредита от 10 000 до 50 000 в разрезе по типу продукта (NAME_CONTRACT_TYPE) в previous_application.",
      "success": true,
      "generation_time": 1.451819896697998,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS average_approved_credit_amount FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.8359788359788359,
        "tables_match": true,
        "where_similarity": 1.0,
        "agg_match": true,
        "group_match": true,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS average_approved_credit_amount FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select name_contract_type, avg(amt_credit) as average_approved_credit_amount from previous_application where amt_credit between 10000 and 50000 group by name_contract_type limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_credit between 10000 and 50000 group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 3,
        "expected_rows": 3
      },
      "retry_count": 0,
      "confidence": 0.55
    },
    {
      "test_id": 6,
      "question": "Сформируйте витрину по previous_application, где для предыдущих заявок с суммой кредита от 10 000 до 50 000 и по каждому значению поля NAME_CONTRACT_TYPE показывается средний размер одобренного кредита по предыдущим обращениям.",
      "success": true,
      "generation_time": 0.8807766437530518,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.8610354223433242,
        "tables_match": true,
        "where_similarity": 1.0,
        "agg_match": true,
        "group_match": true,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select name_contract_type, avg(amt_credit) as avg_approved_credit from previous_application where amt_credit between 10000 and 50000 group by name_contract_type limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_credit between 10000 and 50000 group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 3,
        "expected_rows": 3
      },
      "retry_count": 0,
      "confidence": 0.55
    },
    {
      "test_id": 7,
      "question": "Как в среднем изменяется размер одобренного кредита по предыдущим заявкам для прошлых кредитов среднего размера (10 000–50 000) между клиентами между различными типами кредитных продуктов в прошлых заявках?",
      "success": false,
      "error": "SQL generation failed after 2 attempts. Last error: (psycopg2.errors.UndefinedColumn) column pb.sk_id_prev does not exist\nLINE 1: ...S pa JOIN bureau_balance AS pb ON pa.SK_ID_PREV = pb.SK_ID_P...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"pa.sk_id_prev\".\n\n[SQL: EXPLAIN SELECT pb.NAME_CONTRACT_STATUS, AVG(pa.AMT_CREDIT) AS average_approved_credit_amount FROM previous_application AS pa JOIN bureau_balance AS pb ON pa.SK_ID_PREV = pb.SK_ID_PREV WHERE pa.AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY pb.NAME_CONTRACT_STATUS ORDER BY pb.NAME_CONTRACT_STATUS LIMIT 100]\n(Background on this error at: https://sqlalche.me/e/20/f405)",
      "generation_time": 3.2598676681518555,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": null,
      "comparison": null
    },
    {
      "test_id": 8,
      "question": "Сравните размер одобренного кредита по предыдущим заявкам для прошлых кредитов среднего размера (10 000–50 000) для разных категорий по признаку «тип кредитного продукта» в прошлых заявках клиентов.",
      "success": true,
      "generation_time": 0.7673435211181641,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT prev_app.NAME_CONTRACT_TYPE, AVG(prev_app.AMT_CREDIT) AS average_approved_credit FROM previous_application AS prev_app WHERE prev_app.AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY prev_app.NAME_CONTRACT_TYPE LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.7541766109785203,
        "tables_match": true,
        "where_similarity": 0.8831168831168831,
        "agg_match": true,
        "group_match": true,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT prev_app.NAME_CONTRACT_TYPE, AVG(prev_app.AMT_CREDIT) AS average_approved_credit FROM previous_application AS prev_app WHERE prev_app.AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY prev_app.NAME_CONTRACT_TYPE LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_CREDIT BETWEEN 10000 AND 50000 GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select prev_app.name_contract_type, avg(prev_app.amt_credit) as average_approved_credit from previous_application as prev_app where prev_app.amt_credit between 10000 and 50000 group by prev_app.name_contract_type limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_credit between 10000 and 50000 group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 3,
        "expected_rows": 3
      },
      "retry_count": 0,
      "confidence": 0.4
    },
    {
      "test_id": 9,
      "question": "По таблице previous_application рассчитайте средний размер одобренного кредита по предыдущим обращениям для заявок, где запрошенная сумма больше одобренной (AMT_APPLICATION > AMT_CREDIT) в разрезе по типу продукта (NAME_CONTRACT_TYPE) в previous_application.",
      "success": true,
      "generation_time": 0.9178094863891602,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.856338028169014,
        "tables_match": true,
        "where_similarity": 1.0,
        "agg_match": true,
        "group_match": true,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT NAME_CONTRACT_TYPE, AVG(AMT_CREDIT) AS avg_approved_credit FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_CONTRACT_TYPE LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select name_contract_type, avg(amt_credit) as avg_approved_credit from previous_application where amt_application > amt_credit group by name_contract_type limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_application > amt_credit group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 2,
        "expected_rows": 2
      },
      "retry_count": 0,
      "confidence": 0.55
    },
    {
      "test_id": 10,
      "question": "Сформируйте витрину по previous_application, где для заявок, где запрошенная сумма больше одобренной (AMT_APPLICATION > AMT_CREDIT) и по каждому значению поля NAME_CONTRACT_TYPE показывается средний размер одобренного кредита по предыдущим обращениям.",
      "success": true,
      "generation_time": 1.1996712684631348,
      "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
      "generated_sql": "SELECT pa.NAME_CONTRACT_TYPE, AVG(pa.AMT_CREDIT) AS avg_amt_credit FROM previous_application AS pa WHERE pa.AMT_APPLICATION > pa.AMT_CREDIT GROUP BY pa.NAME_CONTRACT_TYPE LIMIT 100",
      "comparison": {
        "exact_match": false,
        "similarity": 0.8301886792452831,
        "tables_match": true,
        "where_similarity": 0.9032258064516129,
        "agg_match": true,
        "group_match": true,
        "generated_tables": [
          "previous_application"
        ],
        "expected_tables": [
          "previous_application"
        ],
        "generated_sql": "SELECT pa.NAME_CONTRACT_TYPE, AVG(pa.AMT_CREDIT) AS avg_amt_credit FROM previous_application AS pa WHERE pa.AMT_APPLICATION > pa.AMT_CREDIT GROUP BY pa.NAME_CONTRACT_TYPE LIMIT 100",
        "expected_sql": "SELECT NAME_CONTRACT_TYPE AS group_key, AVG(AMT_CREDIT) AS avg_amt_credit FROM previous_application WHERE AMT_APPLICATION > AMT_CREDIT GROUP BY NAME_CONTRACT_TYPE ORDER BY avg_amt_credit DESC;",
        "generated_normalized": "select pa.name_contract_type, avg(pa.amt_credit) as avg_amt_credit from previous_application as pa where pa.amt_application > pa.amt_credit group by pa.name_contract_type limit 100",
        "expected_normalized": "select name_contract_type as group_key, avg(amt_credit) as avg_amt_credit from previous_application where amt_application > amt_credit group by name_contract_type order by avg_amt_credit desc",
        "semantic_correct": false,
        "generated_rows": 2,
        "expected_rows": 2
      },
      "retry_count": 0,
      "confidence": 0.55
    }
  ]
}